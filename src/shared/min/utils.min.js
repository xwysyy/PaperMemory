let i18n={_lang:"en",_messages:{en:{"popup.intro":"automatically records and organizes the papers you read, without ever leaving your browser.","popup.intro2":"When opening a paper (its web page or pdf), a reference to that paper will be stored in your Memory. Supports Arxiv, Open Review, PNAS, Science, Nature","popup.andMore":"and more","popup.requestVenue":"Request a new venue","popup.clickOn":"Click on the","popup.memoryButtonBelow":"Memory button below","popup.orPress":"(or press","popup.userGuide":"User Guide","popup.parseWebsite":"Parse current website","memory.search":"Search","memory.searchEntries":"Search {n} entries ...","memory.showFavoritesOnly":"Show favorites only","memory.lastOpen":"Last Open","memory.lastAdded":"Last Added","memory.year":"Year","memory.title":"Title","memory.visits":"# Visits","memory.id":"ID","memory.lastFavoured":"Last favoured","memory.tagsList":"Tags list","paper.added":"Added","paper.lastOpen":"Last open","paper.visits":"Visits","paper.source":"Source","paper.publication":"Publication","action.edit":"Edit paper details","action.copyMd":"Copy Markdown-formatted link","action.copyBibtex":"Copy Bibtex citation","action.visits":"Number of times you have opened this paper","action.openLocal":"Open downloaded pdf","action.copyLink":"Copy paper url","action.copyHyperLink":"Copy url as hyperlink","action.openSciRate":"Open on SciRate","action.openAlphaXiv":"Open on AlphaXiv","action.openAr5iv":"Open on ar5iv","action.openHuggingFace":"Open on HuggingFace Papers","action.downloadPdf":"Download pdf","action.copyLinkToPaper":"Copy link to paper","action.copyHyperlinkToPaper":"Copy hyperlink to paper","action.deleteFromMemory":"Delete from Memory","action.clickToSeeMetadata":"Click to see metadata","action.openTabTo":"Open tab to {title}","action.copyUrlTo":"Copy URL to the paper's {type}","action.openPaper":"Open Paper {name} Page","action.deletePaperFromMemory":"Delete paper from Memory","form.tags":"Tags:","form.code":"Code:","form.note":"Note:","form.addLink":"Add link","form.addCodeLink":"Add code link","form.anythingToNote":"Anything to note?","form.done":"Done","form.save":"Save","form.favorite":"Favorite:","form.tagPaper":"Tag paper","modal.confirmDelete":"Are you sure you want to delete:","modal.cancel":"Cancel","modal.confirm":"Confirm","feedback.mdLinkCopied":"Markdown {type} link copied!","feedback.bibtexCopied":"Bibtex copied!","feedback.linkCopied":"{type} link copied!","feedback.hyperlinkCopied":"Hyperlink copied!","feedback.titleCopied":"Title copied!","feedback.bibtexCitationCopied":"Bibtex citation copied!","feedback.hyperlinkCopiedType":"{type} hyperlink copied!","feedback.mdCopied":"Markdown {type} copied!","sync.syncing":"Syncing","sync.synced":"Synced","sync.failed":"Sync failed","noPaper.title":"This paper is not in your Memory","noPaper.hereIs":"Here's a {animal} for your trouble","noPaper.tryManual":"Try manual trigger","menu.feedback":"Feedback","menu.feedbackDesc":"It's the little things that make your research smoother.","menu.feedbackDesc2":"Look at the code ; raise issues ; share improvement ideas","menu.help":"Help","menu.userGuide":"User guide","menu.documentation":"Documentation:","menu.configuration":"Configuration","menu.advanced":"Advanced","menu.openSettings":"Open settings","menu.arxivEnhancement":"Arxiv.org enhancement","menu.addPdfDownload":"Add PDF direct download button","menu.addMdLink":"Add Markdown Link section","menu.addBibtex":"Add BibTex citation section","menu.userInterface":"User Interface","menu.displayNotification":"Display notification when a paper is added","menu.useDarkMode":"Use Dark Mode","menu.directOpenMemory":"Directly open the Memory when not on a Paper's page","menu.changeTabTitles":"Change paper tab titles","menu.addSciRate":"Add a link to SciRate in the popup","menu.addAlphaXiv":"Add a link to AlphaXiv in the popup","menu.addAr5iv":"Add a link to ar5iv in the popup","menu.addHuggingFace":"Add a link to the HuggingFace paper page in the popup (Arxiv only)","menu.functionalities":"Functionalities","menu.mdYearVenue":"Include a paper's venue and year when available in the Markdown link","menu.preferPdf":"Favor PDFs for paper links (otherwise, links will point to a paper's abstract page)","menu.pdfOnly":"Only record papers on their pdf pages, not from their abstracts","menu.noAuto":"Disable automatic recording of papers. You will have to manually open the popup and click a button","menu.enterLocalPdf":"When hitting Enter on a memory item, open a local PDF file when one is available instead of the the link to the paper.","menu.storePdfs":"Download pdfs to PaperMemory's folder in your Downloads to be able to open them instead of re-downloading.","menu.websiteParsing":"Enable parsing of arbitrary website by adding a button in the popup. This is still very experimental, see #146 on Github.","menu.keyboardNav":"Keyboard Navigation","menu.openBibMatcher":"PaperMemory BibMatcher","menu.fullPageMemory":"full-page memory","menu.optionsPage":"options page","options.title":"PaperMemory Options","options.introHtml":'<em>These customization options are complementary to those available in the popup such as Dark Theme or Notifications. You can also access your full-screen memory <a target="_blank" href="chrome-extension://ehchlpggdaffcncbeopdopnndhdjelbc/src/fullMemory/fullMemory.html">here</a></em>.',"options.warningHtml":"<em><strong>Warning:</strong> features which alter your Memory such as publication matching, importing papers or overwriting your Memory should not be triggered while you are browsing papers. This would have unpredictable effects as you would concurrently write to the same database.</em>","options.pwcPrefs":"PapersWithCode preferences","options.pwcOfficial":"[1] Only store <em>official</em> code repositories: ","options.pwcFramework":"[2] Preferred implementation framework:","options.noPreference":"No preference","options.about":"About","options.pwcAboutP1":"If you select option [1] and PapersWithCode reports no official implementation for the paper then no repository will be stored, even if there are non-official implementations. Otherwise, official implementations will always be preferred.","options.pwcAboutP2":"If a framework is selected in [2] and such an implementation is available, all other implementations will be ignored.","options.pwcAboutP3":"If multiple code repositories are available at this point, PaperMemory will store the one with most stars.","options.autoTagging":"Auto-tagging","options.autoTagDesc":"Provide Javascript regular expressions to automatically add tags to papers based on their titles and authors. The two columns represent an <code>AND</code>. Use two different entries for an <code>OR</code>. Matching is <strong>not</strong> case-sensitive. An empty input matches everything, it is equivalent to <code>.*</code>.","options.autoTagAuthors":"The Authors RegEx will be matched against a string which joins authors in a BibTex fashion, <em>e.g.</em> <code>Abc Def and Ghi Jkl and Mno Pqr</code>.","options.autoTagExample":'For instance, to match all papers containing <code>"GAN"</code> the corresponding Title RegEx could be <code>.*gan.*</code> (note this would match <em>any</em> title containing those 3 letters subsequently).',"options.titleRegex":"Title RegEx","options.authorsRegex":"Authors RegEx","options.tagsToUse":"Tags to use","options.commaSeparated":"comma-separated","options.preprintMatching":"Preprint matching","options.preprintDesc":'In this section, you can manually trigger the <a href="https://github.com/vict0rsch/PaperMemory#preprints" rel="noopenner noreferrer" target="_blank">preprint matching procedure</a> to discover publications from Arxiv pre-prints and code for your papers from paperswithcode.com.',"options.preprintNote":"A paper's <code>note</code> will only be updated to <code>Accepted @ venue (year) -- [source]</code> <strong><em>if</em></strong>&nbsp; you don't have a custom note already.","options.preprintCount":'You currently have <span id="preprints-number"></span> papers missing a publication venue.',"options.startMatching":"Start the matching procedure","options.selectSources":"Select Sources","options.srcDesc1":"If you don't want to track papers from <emph>all</emph> the sources PaperMemory can handle, you can disable them here.","options.srcDesc2":"Note that you can only disable per <strong>source</strong> not exact venue. For instance you cannot distinguish between Nature Communications and Nature Climate Change (both <code>nature</code> venues) or between CVPR and ICCV (both <code>cvf</code> venues).","options.srcParse":"Sources to parse papers from:","options.dataManagement":"Data Management","options.dmDesc1":"You can export your Memory as a <code>json</code> file or as a bibliography.","options.dmDesc2":"To perform advanced data manipulation (paper merges, batch tagging etc.) you can process the exported Memory file and then load it into the extension, overwriting your current data.","options.dmDesc3":"You can also share a list of papers for others in your team!","options.fullExports":"Full Memory Exports","options.exportBib":" &gt; Export the Memory as a BibTex <strong>bibliography</strong>: ","options.exportData":" &gt; Export your full Memory <strong>data</strong>: ","options.loadJson":' &gt; Load a <code>json</code> memory file (this will <strong style="text-decoration: underline;">overwrite</strong> your Memory): ',"options.selectFile":"Select file","options.exportByTags":"Export by tags","options.exportTagsDesc1":"Select papers to export by providing a list of tags. If you select the <code>AND</code> operator, papers will be required to have all those tags. If you select the <code>OR</code> operator, papers will be required to have at least one of those tags.","options.exportTagsDesc2":'You can export to <code>.bib</code> for bibliographies, or to <code>.json</code>. In the latter case you can choose to either just export URLs, or include <code>title</code>, <code>codeLink</code> and <code>tags</code> fields (in order to match the <a href="#import-papers">import format</a>, and <code>title</code> is just for the sake of human readability)',"options.importPapers":"Import papers","options.importDesc1":"PaperMemory lets you add papers from a list of URLs in the form of a <code>.json</code> file.","options.importDesc2":'The file must be structured as follows: a list of entries where each entry is either a <code>string</code> pointing to a paper\'s <code>url</code> (PDF or abstract) or an <code>object</code> with a mandatory <code>"url": string</code> field and <em>optionally</em> :<ul><li>a <code>"codeLink": string</code> field pointing a to code repository</li><li>a <code>"tags": Array&lt;string&gt;</code> field with tags.</li></ul>',"options.importNote1":"<strong><em>Note&nbsp;&nbsp;&nbsp;</em></strong>&nbsp;: all URLs must come from sources known to PaperMemory","options.importNote2":"<strong><em>Note 2</em></strong>&nbsp;: If you have enabled online synchronization through Github Gists, be aware that synchronization will only happen after <em>all</em> imported papers have been parsed.","options.importExample":"Example valid <code>.json</code> file:","options.onlineSync":"Online synchronization","options.syncHowTitle":"How it works","options.syncHowList":'<li>Your Memory data gets written to a <code>.json</code> file as a gist on your Github account (<a href="https://docs.github.com/en/get-started/writing-on-github/editing-and-sharing-content-with-gists/creating-gists#about-gists" target="_blank" rel="noopener noreferrer">read about gists</a>)</li><li>Although it is non-discoverable, your gist data is still accessible to someone you\'d give the link to</li><li>The synchronization happens in 2 stages:<ul><li><em>Push</em>&nbsp;: when you close the Popup or when a paper gets added to the memory, the remote gist gets overwritten</li><li><em>Pull</em>&nbsp;&nbsp;&nbsp;: when you open the popup or before a paper gets added, the remote gist is downloaded and overwrites your local Memory</li></ul></li><li>This is all very alpha!</li>',"options.syncSequential":"Syncing is meant for <em>sequential</em> use across multiple devices.","options.syncNotMultiUser":"Syncing does <strong>NOT</strong> turn PaperMemory into a multi-user tool: in its current state, PaperMemory will NOT handle conflicts or concurrent writes to the remote data. Any conflict will result in potential loss of data.","options.syncSyncingTitle":"Syncing","options.syncPatDesc":'PaperMemory relies on Github\'s <em>Personal Access Tokens</em> which you can easily generate from your Github account. Make sure<ol><li>It has no expiration date</li><li>The <code>gist</code> scope is selected</li></ol>You can revoke the token later at any time. Click <a href="https://github.com/settings/tokens/new?scopes=gist" target="_blank" rel="noopener noreferrer">here</a> to generate a new token.',"options.patLabel":"Github Personal Access Token:","options.patNote":"Note: your token is saved locally and does not leave your computer.","options.startSyncTitle":"Start syncing your data to Github?","options.startSyncDesc":"Your data will be stored as a Gist on your personal github account. Do <strong>not</strong> edit that file manually or you may corrupt your whole data.","options.startSyncBackup":"In case anything goes wrong, we'll still download a backup locally","options.stopSyncTitle":"STOP syncing your data to Github?","options.stopSyncDesc":"The Gist will not be deleted, but changes to your Memory will not be synced anymore.","options.footerText":"<em>If you like PaperMemory please consider sharing, starring on Github and rating on the Chrome/Firefox webstores</em>","options.modalConflictTitle":"Syncronization conflict","options.modalConflictDesc":"You seem to already have a synced Memory. What do you want to do?","options.modalConflictList":"<li>Overwrite your LOCAL data with the REMOTE data</li><li>Overwrite your REMOTE data with the LOCAL data</li><li>Merge both data sources into the union of all papers</li><li>Abort this procedure.</li>","options.modalConflictNote":"<strong><em>Note&nbsp;:</em></strong>&nbsp; All overwritten data will be saved to your <code>Downloads/</code> folder in case anything goes wrong.","options.modalOverwriteLocal":"1. Overwrite local with remote","options.modalOverwriteRemote":"2. Overwrite remote with local","options.modalMerge":"3. Merge both data sources","options.modalCancelSync":"Cancel synchronization","options.modalWarnP1":"You are about to enable Syncing across devices with Github Gists.","options.modalWarnP2":"This popup is simply to make sure everything is clear on what will happen","options.modalWarnP3":'In particular, make sure you have read and understood the <a href="chrome-extension://ehchlpggdaffcncbeopdopnndhdjelbc/src/options/options.html#sync-how-it-works" id="modal-sync-warning-description">description of the feature</a> before continuing.',"options.modalWarnAdditional":"Additionally:<ul><li>Syncronization typically takes approximately 2-3 seconds to <em>Pull</em> or to <em>Push</em> the data.</li><li>Therefore, if you modify your memory (add tags, notes, delete a paper) from the popup and then close it, your modifications will be lost so you have to make sure the app is done syncing before leaving the popup.</li><li>In most cases, the above is not critical. But it may explain why you feel like some of your actions are not recored or overwritten.</li></ul>","options.modalWarnInterval":"In general, you can consider that PaperMemory expects around <strong>5-10 seconds between devices</strong> to work properly.","options.modalWarnCancel":"Cancel Synchronization.","options.modalWarnContinue":"Ok, let's do this!","lang.switch":"EN/中"},zh:{"popup.intro":"自动记录和整理你阅读的论文，无需离开浏览器。","popup.intro2":"打开论文（网页或PDF）时，该论文的引用将存储在你的记忆库中。支持 Arxiv、Open Review、PNAS、Science、Nature","popup.andMore":"等更多","popup.requestVenue":"请求新的期刊/会议","popup.clickOn":"点击下方的","popup.memoryButtonBelow":"记忆库按钮","popup.orPress":"（或按","popup.userGuide":"使用指南","popup.parseWebsite":"解析当前网站","memory.search":"搜索","memory.searchEntries":"搜索 {n} 条记录...","memory.showFavoritesOnly":"仅显示收藏","memory.lastOpen":"最近打开","memory.lastAdded":"最近添加","memory.year":"年份","memory.title":"标题","memory.visits":"访问次数","memory.id":"ID","memory.lastFavoured":"最近收藏","memory.tagsList":"标签列表","paper.added":"添加时间","paper.lastOpen":"最近打开","paper.visits":"访问次数","paper.source":"来源","paper.publication":"发表","action.edit":"编辑论文详情","action.copyMd":"复制 Markdown 格式链接","action.copyBibtex":"复制 BibTeX 引用","action.visits":"你打开此论文的次数","action.openLocal":"打开已下载的 PDF","action.copyLink":"复制论文链接","action.copyHyperLink":"复制超链接","action.openSciRate":"在 SciRate 上打开","action.openAlphaXiv":"在 AlphaXiv 上打开","action.openAr5iv":"在 ar5iv 上打开","action.openHuggingFace":"在 HuggingFace Papers 上打开","action.downloadPdf":"下载 PDF","action.copyLinkToPaper":"复制论文链接","action.copyHyperlinkToPaper":"复制论文超链接","action.deleteFromMemory":"从记忆库中删除","action.clickToSeeMetadata":"点击查看元数据","action.openTabTo":"打开 {title} 的标签页","action.copyUrlTo":"复制论文 {type} 的链接","action.openPaper":"打开论文 {name} 页面","action.deletePaperFromMemory":"从记忆库中删除论文","form.tags":"标签：","form.code":"代码：","form.note":"笔记：","form.addLink":"添加链接","form.addCodeLink":"添加代码链接","form.anythingToNote":"有什么要记录的？","form.done":"完成","form.save":"保存","form.favorite":"收藏：","form.tagPaper":"标记论文","modal.confirmDelete":"确定要删除：","modal.cancel":"取消","modal.confirm":"确认","feedback.mdLinkCopied":"Markdown {type} 链接已复制！","feedback.bibtexCopied":"BibTeX 已复制！","feedback.linkCopied":"{type} 链接已复制！","feedback.hyperlinkCopied":"超链接已复制！","feedback.titleCopied":"标题已复制！","feedback.bibtexCitationCopied":"BibTeX 引用已复制！","feedback.hyperlinkCopiedType":"{type} 超链接已复制！","feedback.mdCopied":"Markdown {type} 已复制！","sync.syncing":"同步中","sync.synced":"已同步","sync.failed":"同步失败","noPaper.title":"此论文不在你的记忆库中","noPaper.hereIs":"送你一只 {animal} 聊表歉意","noPaper.tryManual":"尝试手动触发","menu.feedback":"反馈","menu.feedbackDesc":"细节决定研究效率。","menu.feedbackDesc2":"查看代码；提交问题；分享改进想法","menu.help":"帮助","menu.userGuide":"使用指南","menu.documentation":"文档：","menu.configuration":"配置","menu.advanced":"高级","menu.openSettings":"打开设置","menu.arxivEnhancement":"Arxiv.org 增强","menu.addPdfDownload":"添加 PDF 直接下载按钮","menu.addMdLink":"添加 Markdown 链接区域","menu.addBibtex":"添加 BibTeX 引用区域","menu.userInterface":"用户界面","menu.displayNotification":"添加论文时显示通知","menu.useDarkMode":"使用深色模式","menu.directOpenMemory":"不在论文页面时直接打开记忆库","menu.changeTabTitles":"修改论文标签页标题","menu.addSciRate":"在弹窗中添加 SciRate 链接","menu.addAlphaXiv":"在弹窗中添加 AlphaXiv 链接","menu.addAr5iv":"在弹窗中添加 ar5iv 链接","menu.addHuggingFace":"在弹窗中添加 HuggingFace 论文页面链接（仅限 Arxiv）","menu.functionalities":"功能","menu.mdYearVenue":"在 Markdown 链接中包含论文的会议和年份（如有）","menu.preferPdf":"优先使用 PDF 链接（否则链接将指向论文摘要页）","menu.pdfOnly":"仅在 PDF 页面记录论文，不从摘要页记录","menu.noAuto":"禁用自动记录论文。你需要手动打开弹窗并点击按钮","menu.enterLocalPdf":"按 Enter 时，如有本地 PDF 则打开本地文件而非论文链接。","menu.storePdfs":"将 PDF 下载到 PaperMemory 的下载文件夹，以便直接打开而非重新下载。","menu.websiteParsing":"启用任意网站解析（在弹窗中添加按钮）。此功能仍为实验性，详见 Github #146。","menu.keyboardNav":"键盘导航","menu.openBibMatcher":"PaperMemory BibMatcher","menu.fullPageMemory":"全页记忆库","menu.optionsPage":"选项页面","options.title":"PaperMemory 选项","options.introHtml":'<em>这些自定义选项是弹窗中可用选项（如深色主题或通知）的补充。你也可以在<a target="_blank" href="chrome-extension://ehchlpggdaffcncbeopdopnndhdjelbc/src/fullMemory/fullMemory.html">这里</a>访问全屏记忆库</em>。',"options.warningHtml":"<em><strong>警告：</strong>修改记忆库的功能（如出版物匹配、导入论文或覆盖记忆库）不应在浏览论文时触发，否则会因并发写入同一数据库而产生不可预测的效果。</em>","options.pwcPrefs":"PapersWithCode 偏好设置","options.pwcOfficial":"[1] 仅存储<em>官方</em>代码仓库：","options.pwcFramework":"[2] 首选实现框架：","options.noPreference":"无偏好","options.about":"说明","options.pwcAboutP1":"如果选择了选项 [1] 且 PapersWithCode 未报告该论文的官方实现，则不会存储任何仓库，即使存在非官方实现。否则，官方实现将始终优先。","options.pwcAboutP2":"如果在 [2] 中选择了框架且有对应实现，则其他所有实现将被忽略。","options.pwcAboutP3":"如果此时仍有多个代码仓库可用，PaperMemory 将存储星标最多的那个。","options.autoTagging":"自动标签","options.autoTagDesc":"提供 JavaScript 正则表达式，根据论文标题和作者自动添加标签。两列表示 <code>AND</code>（与）关系。使用两个不同条目表示 <code>OR</code>（或）关系。匹配<strong>不</strong>区分大小写。空输入匹配所有内容，等同于 <code>.*</code>。","options.autoTagAuthors":"作者正则将匹配以 BibTeX 格式连接的作者字符串，<em>例如</em> <code>Abc Def and Ghi Jkl and Mno Pqr</code>。","options.autoTagExample":'例如，要匹配所有包含 <code>"GAN"</code> 的论文，对应的标题正则可以是 <code>.*gan.*</code>（注意这会匹配<em>任何</em>连续包含这3个字母的标题）。',"options.titleRegex":"标题正则","options.authorsRegex":"作者正则","options.tagsToUse":"使用的标签","options.commaSeparated":"逗号分隔","options.preprintMatching":"预印本匹配","options.preprintDesc":'在此部分，你可以手动触发<a href="https://github.com/vict0rsch/PaperMemory#preprints" rel="noopenner noreferrer" target="_blank">预印本匹配流程</a>，从 Arxiv 预印本中发现出版物，并从 paperswithcode.com 获取论文代码。',"options.preprintNote":"论文的 <code>note</code> 仅在你没有自定义备注时才会更新为 <code>Accepted @ venue (year) -- [source]</code>。","options.preprintCount":'你目前有 <span id="preprints-number"></span> 篇论文缺少出版信息。',"options.startMatching":"开始匹配流程","options.selectSources":"选择来源","options.srcDesc1":"如果你不想追踪 PaperMemory 支持的<emph>所有</emph>来源的论文，可以在此禁用。","options.srcDesc2":"注意你只能按<strong>来源</strong>禁用，而非精确的期刊/会议。例如你无法区分 Nature Communications 和 Nature Climate Change（都是 <code>nature</code> 来源），也无法区分 CVPR 和 ICCV（都是 <code>cvf</code> 来源）。","options.srcParse":"要解析论文的来源：","options.dataManagement":"数据管理","options.dmDesc1":"你可以将记忆库导出为 <code>json</code> 文件或参考文献。","options.dmDesc2":"要进行高级数据操作（论文合并、批量标签等），你可以处理导出的记忆库文件，然后加载到扩展中覆盖当前数据。","options.dmDesc3":"你还可以与团队成员分享论文列表！","options.fullExports":"完整记忆库导出","options.exportBib":" &gt; 将记忆库导出为 BibTeX <strong>参考文献</strong>：","options.exportData":" &gt; 导出完整记忆库<strong>数据</strong>：","options.loadJson":' &gt; 加载 <code>json</code> 记忆库文件（这将<strong style="text-decoration: underline;">覆盖</strong>你的记忆库）：',"options.selectFile":"选择文件","options.exportByTags":"按标签导出","options.exportTagsDesc1":"通过提供标签列表来选择要导出的论文。如果选择 <code>AND</code> 运算符，论文需要包含所有这些标签。如果选择 <code>OR</code> 运算符，论文只需包含其中一个标签。","options.exportTagsDesc2":'你可以导出为 <code>.bib</code> 格式的参考文献，或 <code>.json</code> 格式。后者可以选择仅导出 URL，或包含 <code>title</code>、<code>codeLink</code> 和 <code>tags</code> 字段（以匹配<a href="#import-papers">导入格式</a>，<code>title</code> 仅为方便阅读）',"options.importPapers":"导入论文","options.importDesc1":"PaperMemory 允许你通过 <code>.json</code> 文件中的 URL 列表添加论文。","options.importDesc2":'文件结构如下：一个条目列表，每个条目可以是指向论文 <code>url</code>（PDF 或摘要）的 <code>string</code>，或包含必填 <code>"url": string</code> 字段的 <code>object</code>，以及<em>可选</em>的：<ul><li><code>"codeLink": string</code> 字段，指向代码仓库</li><li><code>"tags": Array&lt;string&gt;</code> 字段，包含标签</li></ul>',"options.importNote1":"<strong><em>注意</em></strong>：所有 URL 必须来自 PaperMemory 已知的来源","options.importNote2":"<strong><em>注意 2</em></strong>：如果你启用了通过 Github Gists 的在线同步，请注意同步将在<em>所有</em>导入的论文解析完成后才会进行。","options.importExample":"有效的 <code>.json</code> 文件示例：","options.onlineSync":"在线同步","options.syncHowTitle":"工作原理","options.syncHowList":'<li>你的记忆库数据会以 <code>.json</code> 文件的形式写入 Github 账户的 Gist（<a href="https://docs.github.com/en/get-started/writing-on-github/editing-and-sharing-content-with-gists/creating-gists#about-gists" target="_blank" rel="noopener noreferrer">了解 Gists</a>）</li><li>虽然 Gist 不可被搜索发现，但拥有链接的人仍可访问你的数据</li><li>同步分为两个阶段：<ul><li><em>推送</em>：关闭弹窗或添加论文时，远程 Gist 会被覆盖</li><li><em>拉取</em>：打开弹窗或添加论文前，远程 Gist 会被下载并覆盖本地记忆库</li></ul></li><li>此功能仍处于早期阶段！</li>',"options.syncSequential":"同步适用于多设备间的<em>顺序</em>使用。","options.syncNotMultiUser":"同步<strong>不会</strong>将 PaperMemory 变成多用户工具：当前状态下，PaperMemory 不会处理冲突或并发写入远程数据。任何冲突都可能导致数据丢失。","options.syncSyncingTitle":"同步设置","options.syncPatDesc":'PaperMemory 依赖 Github 的<em>个人访问令牌</em>，你可以从 Github 账户轻松生成。请确保<ol><li>令牌没有过期日期</li><li>选择了 <code>gist</code> 权限范围</li></ol>你可以随时撤销令牌。点击<a href="https://github.com/settings/tokens/new?scopes=gist" target="_blank" rel="noopener noreferrer">这里</a>生成新令牌。',"options.patLabel":"Github 个人访问令牌：","options.patNote":"注意：你的令牌仅保存在本地，不会离开你的电脑。","options.startSyncTitle":"开始将数据同步到 Github？","options.startSyncDesc":"你的数据将以 Gist 形式存储在你的个人 Github 账户上。请<strong>不要</strong>手动编辑该文件，否则可能损坏所有数据。","options.startSyncBackup":"如果出现问题，我们仍会在本地下载备份","options.stopSyncTitle":"停止将数据同步到 Github？","options.stopSyncDesc":"Gist 不会被删除，但记忆库的更改将不再同步。","options.footerText":"<em>如果你喜欢 PaperMemory，请考虑分享、在 Github 上加星以及在 Chrome/Firefox 商店评分</em>","options.modalConflictTitle":"同步冲突","options.modalConflictDesc":"你似乎已有同步的记忆库。你想怎么做？","options.modalConflictList":"<li>用远程数据覆盖本地数据</li><li>用本地数据覆盖远程数据</li><li>合并两个数据源（取所有论文的并集）</li><li>中止此操作</li>","options.modalConflictNote":"<strong><em>注意：</em></strong>所有被覆盖的数据将保存到 <code>Downloads/</code> 文件夹以防万一。","options.modalOverwriteLocal":"1. 用远程覆盖本地","options.modalOverwriteRemote":"2. 用本地覆盖远程","options.modalMerge":"3. 合并两个数据源","options.modalCancelSync":"取消同步","options.modalWarnP1":"你即将启用通过 Github Gists 的跨设备同步。","options.modalWarnP2":"此弹窗只是为了确保你清楚接下来会发生什么","options.modalWarnP3":'请确保你已阅读并理解<a href="chrome-extension://ehchlpggdaffcncbeopdopnndhdjelbc/src/options/options.html#sync-how-it-works" id="modal-sync-warning-description">功能说明</a>后再继续。',"options.modalWarnAdditional":"此外：<ul><li>同步通常需要约 2-3 秒来<em>拉取</em>或<em>推送</em>数据。</li><li>因此，如果你从弹窗修改记忆库（添加标签、备注、删除论文）后立即关闭，你的修改可能会丢失，请确保同步完成后再离开弹窗。</li><li>大多数情况下这不是关键问题，但这可能解释了为什么你觉得某些操作没有被记录或被覆盖。</li></ul>","options.modalWarnInterval":"一般来说，PaperMemory 需要设备间间隔约 <strong>5-10 秒</strong>才能正常工作。","options.modalWarnCancel":"取消同步","options.modalWarnContinue":"好的，开始吧！","lang.switch":"EN/中"}}},t=(e,a)=>{e=i18n._messages[i18n._lang]?.[e]??i18n._messages.en[e]??e;return a?e.replace(/\{(\w+)\}/g,(e,t)=>a[t]??`{${t}}`):e},setLang=e=>{i18n._lang=e,chrome.storage.local.set({pmLang:e}),applyI18n()},applyI18n=()=>{document.querySelectorAll("[data-i18n]").forEach(e=>{var a=e.getAttribute("data-i18n");a&&(e.textContent=t(a))}),document.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{var a=e.getAttribute("data-i18n-placeholder");a&&(e.placeholder=t(a))}),document.querySelectorAll("[data-i18n-title]").forEach(e=>{var a=e.getAttribute("data-i18n-title");a&&(e.title=t(a))}),document.querySelectorAll("[data-i18n-html]").forEach(e=>{var a=e.getAttribute("data-i18n-html");a&&(e.innerHTML=t(a))});var e=document.getElementById("lang-switch-btn");e&&(e.textContent="en"===i18n._lang?"中文":"EN")},initI18n=()=>new Promise(t=>{"undefined"!=typeof chrome&&chrome?.storage?.local?chrome.storage.local.get("pmLang",({pmLang:e})=>{i18n._lang=e||"en",applyI18n(),t(i18n._lang)}):t(i18n._lang)}),findEl=(!function r(o,i,n){function s(t,e){if(!i[t]){if(!o[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}a=i[t]={exports:{}},o[t][0].call(a.exports,function(e){return s(o[t][1][e]||e)},a,a.exports,r,o,i,n)}return i[t].exports}for(var l="function"==typeof require&&require,e=0;e<n.length;e++)s(n[e]);return s}({1:[function(e,t,a){var r,o,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{o="function"==typeof clearTimeout?clearTimeout:n}catch(e){o=n}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}var l,p=[],c=!1,d=-1;function u(){c&&l&&(c=!1,l.length?p=l.concat(p):d=-1,p.length)&&h()}function h(){if(!c){for(var e=s(u),t=(c=!0,p.length);t;){for(l=p,p=[];++d<t;)l&&l[d].run();d=-1,t=p.length}l=null,c=!1,!function(t){if(o===clearTimeout)return clearTimeout(t);if((o===n||!o)&&clearTimeout)return(o=clearTimeout)(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];p.push(new m(e,t)),1!==p.length||c||s(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=f,t.addListener=f,t.once=f,t.off=f,t.removeListener=f,t.removeAllListeners=f,t.emit=f,t.prependListener=f,t.prependOnceListener=f,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],2:[function(e,t,a){Object.defineProperty(a,"__esModule",{value:!0});e="octokit-endpoint.js/9.0.4 "+(a.endpoint=void 0,e("universal-user-agent").getUserAgent)();function s(t,a){let r=Object.assign({},t);return Object.keys(a).forEach(e=>{(e=>{var t;return"object"==typeof e&&null!==e&&"[object Object]"===Object.prototype.toString.call(e)&&(null===(t=Object.getPrototypeOf(e))||"function"==typeof(t=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor)&&t instanceof t&&Function.prototype.call(t)===Function.prototype.call(e))})(a[e])&&e in t?r[e]=s(t[e],a[e]):Object.assign(r,{[e]:a[e]})}),r}function l(e){for(var t in e)void 0===e[t]&&delete e[t]}function r(e,t,a){var r,o,i;(a="string"==typeof t?([r,o]=t.split(" "),Object.assign(o?{method:r,url:o}:{url:r},a)):Object.assign({},t)).headers=(i=a.headers)?Object.keys(i).reduce((e,t)=>(e[t.toLowerCase()]=i[t],e),{}):{},l(a),l(a.headers);let n=s(e||{},a);return"/graphql"===a.url&&(e&&e.mediaType.previews?.length&&(n.mediaType.previews=e.mediaType.previews.filter(e=>!n.mediaType.previews.includes(e)).concat(n.mediaType.previews)),n.mediaType.previews=(n.mediaType.previews||[]).map(e=>e.replace(/-preview/,""))),n}var d=/\{[^}]+\}/g;function u(e){return e.replace(/^\W+|\W+$/g,"").split(/,/)}function h(e,t){var a,r={__proto__:null};for(a of Object.keys(e))-1===t.indexOf(a)&&(r[a]=e[a]);return r}function n(e){return e.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return e=/%[0-9A-Fa-f]/.test(e)?e:encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")}).join("")}function p(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function c(e,t,a){return t=("+"===e||"#"===e?n:p)(t),a?p(a)+"="+t:t}function m(e){return null!=e}function f(e){return";"===e||"&"===e||"?"===e}function g(e){return{expand:function(e,o){var i=["+","#",".","/",";","?","&"];return"/"===(e=e.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(e,r,t){if(r){let t="",a=[];return-1!==i.indexOf(r.charAt(0))&&(t=r.charAt(0),r=r.substr(1)),r.split(/,/g).forEach(function(e){e=/([^:\*]*)(?::(\d+)|(\*))?/.exec(e);a.push(((e,a,r,t)=>{var o=e[r],i=[];if(m(o)&&""!==o)if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)o=o.toString(),t&&"*"!==t&&(o=o.substring(0,parseInt(t,10))),i.push(c(a,o,f(a)?r:""));else if("*"===t)Array.isArray(o)?o.filter(m).forEach(function(e){i.push(c(a,e,f(a)?r:""))}):Object.keys(o).forEach(function(e){m(o[e])&&i.push(c(a,o[e],e))});else{let t=[];Array.isArray(o)?o.filter(m).forEach(function(e){t.push(c(a,e))}):Object.keys(o).forEach(function(e){m(o[e])&&(t.push(p(e)),t.push(c(a,o[e].toString())))}),f(a)?i.push(p(r)+"="+t.join(",")):0!==t.length&&i.push(t.join(","))}else";"===a?m(o)&&i.push(p(r)):""!==o||"&"!==a&&"?"!==a?""===o&&i.push(""):i.push(p(r)+"=");return i})(o,t,e[1],e[2]||e[3]))}),t&&"+"!==t?(r=",","?"===t?r="&":"#"!==t&&(r=t),(0!==a.length?t:"")+a.join(r)):a.join(",")}return n(t)}))?e:e.replace(/\/$/,"")}.bind(null,e)}}function o(t){var e=t.method.toUpperCase();let a=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}");var r=Object.assign({},t.headers);let o;var i=h(t,["method","baseUrl","url","headers","request","mediaType"]);let n=(c=(c=a).match(d))?c.map(u).reduce((e,t)=>e.concat(t),[]):[];a=g(a).expand(i),/^http/.test(a)||(a=t.baseUrl+a);var s,l,p,c=h(i,Object.keys(t).filter(e=>n.includes(e)).concat("baseUrl"));return/application\/octet-stream/i.test(r.accept)||(t.mediaType.format&&(r.accept=r.accept.split(/,/).map(e=>e.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,"application/vnd$1$2."+t.mediaType.format)).join(",")),a.endsWith("/graphql")&&t.mediaType.previews?.length&&(i=r.accept.match(/[\w-]+(?=-preview)/g)||[],r.accept=i.concat(t.mediaType.previews).map(e=>`application/vnd.github.${e}-preview`+(t.mediaType.format?"."+t.mediaType.format:"+json")).join(","))),["GET","HEAD"].includes(e)?a=(i=a,s=c,l=/\?/.test(i)?"&":"?",0===(p=Object.keys(s)).length?i:i+l+p.map(e=>"q"===e?"q="+s.q.split("+").map(encodeURIComponent).join("+"):e+"="+encodeURIComponent(s[e])).join("&")):"data"in c?o=c.data:Object.keys(c).length&&(o=c),r["content-type"]||void 0===o||(r["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&void 0===o&&(o=""),Object.assign({method:e,url:a,headers:r},void 0!==o?{body:o}:null,t.request?{request:t.request}:null)}function i(e,t){e=r(e,t),t=function(e,t,a){return o(r(e,t,a))}.bind(null,e);return Object.assign(t,{DEFAULTS:e,defaults:i.bind(null,e),merge:r.bind(null,e),parse:o})}a.endpoint=i(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":e},mediaType:{format:""}})},{"universal-user-agent":7}],3:[function(e,t,a){Object.defineProperty(a,"__esModule",{value:!0}),a.RequestError=void 0;var o=e("deprecation"),e=(e=e("once"))&&e.__esModule?e:{default:e};var i=(0,e.default)(e=>console.warn(e)),n=(0,e.default)(e=>console.warn(e)),e=class extends Error{constructor(e,t,a){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=t;let r;"headers"in a&&void 0!==a.headers&&(r=a.headers),"response"in a&&(this.response=a.response,r=a.response.headers);e=Object.assign({},a.request);a.request.headers.authorization&&(e.headers=Object.assign({},a.request.headers,{authorization:a.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),e.url=e.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=e,Object.defineProperty(this,"code",{get(){return i(new o.Deprecation("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),t}}),Object.defineProperty(this,"headers",{get(){return n(new o.Deprecation("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),r||{}}})}};a.RequestError=e},{deprecation:5,once:6}],4:[function(e,t,a){Object.defineProperty(a,"__esModule",{value:!0}),a.request=void 0;var r=e("@octokit/endpoint"),o=e("universal-user-agent"),p=e("@octokit/request-error");function i(r){let o=r.request&&r.request.log?r.request.log:console,i=!1!==r.request?.parseSuccessResponseBody,n=(((e=>{var t;return"object"==typeof e&&null!==e&&"[object Object]"===Object.prototype.toString.call(e)&&(null===(t=Object.getPrototypeOf(e))||"function"==typeof(t=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor)&&t instanceof t&&Function.prototype.call(t)===Function.prototype.call(e))})(r.body)||Array.isArray(r.body))&&(r.body=JSON.stringify(r.body)),{}),s,l,e=globalThis.fetch;if(e=r.request?.fetch?r.request.fetch:e)return e(r.url,{method:r.method,body:r.body,headers:r.headers,signal:r.request?.signal,...r.body&&{duplex:"half"}}).then(async e=>{l=e.url,s=e.status;for(var t of e.headers)n[t[0]]=t[1];var a;if("deprecation"in n&&(a=(a=n.link&&n.link.match(/<([^>]+)>; rel="deprecation"/))&&a.pop(),o.warn(`[@octokit/request] "${r.method} ${r.url}" is deprecated. It is scheduled to be removed on `+n.sunset+(a?". See "+a:""))),204!==s&&205!==s){if("HEAD"===r.method){if(s<400)return;throw new p.RequestError(e.statusText,s,{response:{url:l,status:s,headers:n,data:void 0},request:r})}if(304===s)throw new p.RequestError("Not modified",s,{response:{url:l,status:s,headers:n,data:await c(e)},request:r});if(400<=s)throw a=await c(e),new p.RequestError((e=>"string"==typeof e?e:"message"in e?Array.isArray(e.errors)?e.message+": "+e.errors.map(JSON.stringify).join(", "):e.message:"Unknown error: "+JSON.stringify(e))(a),s,{response:{url:l,status:s,headers:n,data:a},request:r});return i?await c(e):e.body}}).then(e=>({status:s,url:l,headers:n,data:e})).catch(e=>{if(e instanceof p.RequestError)throw e;if("AbortError"===e.name)throw e;let t=e.message;throw"TypeError"===e.name&&"cause"in e&&(e.cause instanceof Error?t=e.cause.message:"string"==typeof e.cause&&(t=e.cause)),new p.RequestError(t,500,{request:r})});throw new Error("fetch is not set. Please pass a fetch implementation as new Octokit({ request: { fetch }}). Learn more at https://github.com/octokit/octokit.js/#fetch-missing")}async function c(e){var t=e.headers.get("content-type");return/application\/json/.test(t)?e.json().catch(()=>e.text()).catch(()=>""):!t||/^text\/|charset=utf-8$/.test(t)?e.text():e.arrayBuffer()}function n(e,t){let a=e.defaults(t);return Object.assign(function(e,t){e=a.merge(e,t);return e.request&&e.request.hook?(t=(e,t)=>i(a.parse(a.merge(e,t))),Object.assign(t,{endpoint:a,defaults:n.bind(null,a)}),e.request.hook(t,e)):i(a.parse(e))},{endpoint:a,defaults:n.bind(null,a)})}a.request=n(r.endpoint,{headers:{"user-agent":"octokit-request.js/8.1.6 "+(0,o.getUserAgent)()}})},{"@octokit/endpoint":2,"@octokit/request-error":3,"universal-user-agent":7}],5:[function(e,t,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Deprecation=void 0;class r extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}a.Deprecation=r},{}],6:[function(e,t,a){e=e("wrappy");function r(e){function t(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))}return t.called=!1,t}function o(e){function t(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)}var a=e.name||"Function wrapped with `once`";return t.onceError=a+" shouldn't be called more than once",t.called=!1,t}t.exports=e(r),t.exports.strict=e(o),r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},{wrappy:8}],7:[function(e,t,a){!function(e){!function(){Object.defineProperty(a,"__esModule",{value:!0}),a.getUserAgent=function(){if("object"==typeof navigator&&"userAgent"in navigator)return navigator.userAgent;return"object"!=typeof e||void 0===e.version?"<environment undetectable>":`Node.js/${e.version.substr(1)} (${e.platform}; ${e.arch})`}}.call(this)}.call(this,e("_process"))},{_process:1}],8:[function(e,t,a){t.exports=function e(o,t){if(o&&t)return e(o)(t);if("function"!=typeof o)throw new TypeError("need wrapper function");Object.keys(o).forEach(function(e){a[e]=o[e]});return a;function a(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];var a=o.apply(this,e),r=e[e.length-1];return"function"==typeof a&&a!==r&&Object.keys(r).forEach(function(e){a[e]=r[e]}),a}}},{}],9:[function(a,e,t){!function(t){!function(){var e=a("@octokit/request").request;"undefined"==typeof window?window=t:t=window,t.octokitRequest=e}.call(this)}.call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@octokit/request":4}]},{},[9]),({element:e,paperId:t,memoryItemClass:a})=>{if(e)return"string"==typeof e?document.getElementById(e):e;if(void 0===a)return warn("findEl: memoryItemClass is undefined ; element was: "+e),null;a.startsWith(".")||(a="."+a);e=findEl({element:"memory-container--"+t});return e?e.querySelector(a):(warn(`findEl: memory-container--${t} not found`),null)}),fadeOut=(e,t=250,a=()=>{})=>{(e=findEl({element:e})).style.transition=t+"ms",e.style.opacity=0,setTimeout(()=>{e.style.display="none",a()},t)},fadeIn=(e,t="block",a=250,r=()=>{})=>{(e=findEl({element:e})).style.opacity=0,"none"===e.style.display&&(e.style.display=t),setTimeout(()=>{e.style.transition=a+"ms",e.style.opacity=1,setTimeout(()=>{r()},a)},0)},val=(e,t)=>{if((e=findEl({element:e}))instanceof HTMLInputElement&&"checkbox"===e.type){if(void 0===t)return e.checked;e.checked=t}if(void 0===t)return e?e.value:"";e&&(e.value=t)},showId=(e,t="block")=>{(e=findEl({element:e}))&&(e.style.display=t)},hideId=e=>{(e=findEl({element:e}))&&(e.style.display="none")},setTextId=(e,t)=>{(e=findEl({element:e}))&&(e.innerText=t)},setHTML=(e,t)=>{(e=findEl({element:e}))&&(e.innerHTML=t)},dispatch=(e,t)=>{if(e=findEl({element:e}),"string"==typeof t){if("focus"===t)return void e.focus();if("blur"===t)return void e.blur();t=new Event(t)}e&&e.dispatchEvent(t)},hasClass=(e,t)=>!!(e=findEl({element:e}))&&e.classList.contains(t),addClass=(e,t)=>{(e=findEl({element:e}))&&e.classList.add(t)},removeClass=(e,t)=>{(e=findEl({element:e}))&&e.classList.remove(t)},addListener=(e,t,a)=>{(e=findEl({element:e}))&&e.addEventListener(t,a)},setPlaceholder=(e,t)=>{(e=findEl({element:e}))&&void 0!==e.placeholder&&(e.placeholder=t)},style=(e,t,a)=>{if(e=findEl({element:e})){if(void 0===a)return e.style[t];e.style[t]=a}},disable=(e,t=!0)=>{(e=findEl({element:e}))&&(e.disabled=t)},slideUp=(e,t=250,a=()=>{})=>{(e=findEl({element:e}))&&(e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=e.offsetHeight+"px",e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,window.setTimeout(()=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.style.removeProperty("box-sizing"),a()},t))},slideDown=(t,a=500,r=()=>{})=>{if(t=findEl({element:t})){t.style.removeProperty("display");let e=window.getComputedStyle(t).display;"none"===e&&(e="block"),t.style.display=e;var o=t.offsetHeight;t.style.overflow="hidden",t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.marginTop=0,t.style.marginBottom=0,t.offsetHeight,t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=a+"ms",t.style.height=o+"px",t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),window.setTimeout(()=>{t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),r()},a)}},queryAll=(e,t)=>t?[...t.querySelectorAll(e)]:[...document.querySelectorAll(e)],querySelector=(e,t)=>(t||document).querySelector(e),createElementFromHTML=e=>{var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},addEventToClass=(e,t,a)=>{e.startsWith(".")||(e="."+e),queryAll(e).forEach(e=>{e.addEventListener(t,a)})};"undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={findEl:findEl,fadeOut:fadeOut,fadeIn:fadeIn,val:val,showId:showId,hideId:hideId,setTextId:setTextId,setHTML:setHTML,dispatch:dispatch,hasClass:hasClass,addClass:addClass,removeClass:removeClass,addListener:addListener,setPlaceholder:setPlaceholder,style:style,disable:disable,slideUp:slideUp,slideDown:slideDown,queryAll:queryAll,querySelector:querySelector,createElementFromHTML:createElementFromHTML,addEventToClass:addEventToClass}),Object.defineProperty(Array.prototype,"last",{value:function(e=0){return this.reverse()[e]}}),Object.defineProperty(String.prototype,"capitalize",{value:function(e=!1){return e?this.split(" ").map(e=>e.capitalize()).join(" "):this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()}});var dummyModule,global={};function BibtexParser(){this.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],this.notKey=[",","{","}"," ","="],this.pos=0,this.input="",this.entries=new Array,this.currentEntry="",this.setInput=function(e){this.input=e},this.getEntries=function(){return this.entries},this.isWhitespace=function(e){return" "==e||"\r"==e||"\t"==e||"\n"==e},this.match=function(e,t){if(this.skipWhitespace(t=null==t?!0:t),this.input.substring(this.pos,this.pos+e.length)!=e)throw TypeError("Token mismatch: match -> expected "+e+", found "+this.input.substring(this.pos));this.pos+=e.length,this.skipWhitespace(t)},this.tryMatch=function(e,t){return this.skipWhitespace(t=null==t?!0:t),this.input.substring(this.pos,this.pos+e.length)==e},this.matchAt=function(){for(;this.input.length>this.pos&&"@"!=this.input[this.pos];)this.pos++;return"@"==this.input[this.pos]},this.skipWhitespace=function(e){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]&&1==e){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace(e)}},this.value_braces=function(){for(var e,t=0,a=(this.match("{",!1),this.pos),r=!1;;){if(!r)if("}"==this.input[this.pos]){if(!(0<t))return e=this.pos,this.match("}",!1),this.input.substring(a,e);t--}else if("{"==this.input[this.pos])t++;else if(this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_braces");r="\\"==this.input[this.pos]&&0==r,this.pos++}},this.value_comment=function(){for(var e="",t=0;!this.tryMatch("}",!1)||0!=t;){if(e+=this.input[this.pos],"{"==this.input[this.pos]&&t++,"}"==this.input[this.pos]&&t--,this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_comment",+this.input.substring(start));this.pos++}return e},this.value_quotes=function(){this.match('"',!1);for(var e,t=this.pos,a=!1;;){if(!a){if('"'==this.input[this.pos])return e=this.pos,this.match('"',!1),this.input.substring(t,e);if(this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_quotes",this.input.substring(t))}a="\\"==this.input[this.pos]&&0==a,this.pos++}},this.single_value=function(){var e=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var t=this.key();if(t.match("^[0-9]+$"))return t;if(0<=this.months.indexOf(t.toLowerCase()))return t.toLowerCase();throw"Value expected: single_value"+this.input.substring(e)+" for key: "+t},this.value=function(){var e=[];for(e.push(this.single_value());this.tryMatch("#");)this.match("#"),e.push(this.single_value());return e.join("")},this.key=function(e){for(var t=this.pos;;){if(this.pos>=this.input.length)throw TypeError("Runaway key: key");if(0<=this.notKey.indexOf(this.input[this.pos]))return e&&","!=this.input[this.pos]?(this.pos=t,null):this.input.substring(t,this.pos);this.pos++}},this.key_equals_value=function(){var e,t=this.key();if(this.tryMatch("="))return this.match("="),e=this.value(),[t=t.trim(),e];throw TypeError("Value expected, equals sign missing: key_equals_value",this.input.substring(this.pos))},this.key_value_list=function(){var e=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[e[0]]=e[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}"));)e=this.key_equals_value(),this.currentEntry.entryTags[e[0]]=e[1]},this.entry_body=function(e){this.currentEntry={},this.currentEntry.citationKey=this.key(!0),this.currentEntry.entryType=e.substring(1),null!=this.currentEntry.citationKey&&this.match(","),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match("@"),"@"+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType="PREAMBLE",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType="COMMENT",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(e){this.entry_body(e)},this.alternativeCitationKey=function(){this.entries.forEach(function(e){!e.citationKey&&e.entryTags&&(e.citationKey="",e.entryTags.author&&(e.citationKey+=e.entryTags.author.split(",")[0]+=", "),e.citationKey+=e.entryTags.year)})},this.cleanCitationKey=function(){var e=this.pos,t=e+this.input.slice(e).indexOf(","),a=this.input.slice(0,e),r=this.input.slice(t),o=this.input.slice(e,t).split("{");let i=o[0];for(var n=1;n<o.length;n++){var s=o[n].split("}");i+=s[0].replace(/\W/g,"")+s[1]}i=i.replace(/\s+/g,""),this.input=a+i+r},this.bibtex=function(){for(;this.matchAt();){var e=this.directive();this.match("{"),this.cleanCitationKey(),"@STRING"==e.toUpperCase()?this.string():"@PREAMBLE"==e.toUpperCase()?this.preamble():"@COMMENT"==e.toUpperCase()?this.comment():this.entry(e),this.match("}")}this.alternativeCitationKey()}}"undefined"!=typeof window&&(global=window),"undefined"!=typeof chrome&&chrome?.runtime?.setUninstallURL&&chrome?.runtime?.setUninstallURL("https://forms.gle/1JSV8PcxQugRmsd46"),global.state={currentMemoryPagination:0,dataVersion:0,deleted:{},files:{},ignoreSources:{},lastRefresh:new Date,memoryIsOpen:!1,memoryItemsPerPage:10,menuIsOpen:!1,modalIsOpen:!1,tooltipIsOpen:!1,papers:{},papersList:[],papersReady:!1,paperTags:new Set,pdfTitleFn:null,prefs:{},showFavorites:!1,sortedPapers:[],sortKey:"",timerIdMap:new WeakMap,titleHashToIds:{},titleFunction:null,urlHashToId:{}},global.state.titleFunction=e=>{let t=e.title.replaceAll("\n","")+" - "+e.id;return t=t.replaceAll(":"," ").replace(/\\s\\s+/g," ")},global.descendingSortKeys=["addDate","count","lastOpenDate","favoriteDate","year"],global.svgActionsHoverTitles={edit:"Edit paper details",copyMd:"Copy Markdown-formatted link",copyBibtext:"Copy Bibtex citation",visits:"Number of times you have opened this paper",openLocal:"Open downloaded pdf",copyLink:"Copy paper url",copyHypeLink:"Copy url as hyperlink"},global.getSvgActionsHoverTitles=()=>"function"==typeof t?{edit:t("action.edit"),copyMd:t("action.copyMd"),copyBibtext:t("action.copyBibtex"),visits:t("action.visits"),openLocal:t("action.openLocal"),copyLink:t("action.copyLink"),copyHypeLink:t("action.copyHyperLink")}:global.svgActionsHoverTitles,global.select2Options={placeholder:"Tag paper",maximumSelectionLength:5,allowClear:!0,tags:!0,tokenSeparators:[","," "]},global.prefsCheckNames=["checkBib","checkMd","checkDownload","checkPdfTitle","checkFeedback","checkDarkMode","checkDirectOpen","checkStore","checkScirate","checkAlphaxiv","checkAr5iv","checkHuggingface","checkOfficialRepos","checkPdfOnly","checkNoAuto","checkMdYearVenue","checkEnterLocalPdf","checkWebsiteParsing"],global.prefsCheckDefaultFalse=["checkDarkMode","checkStore","checkScirate","checkAlphaxiv","checkAr5iv","checkHuggingface","checkOfficialRepos","checkPdfOnly","checkNoAuto","checkMdYearVenue","checkPreferPdf"],global.prefsStorageKeys=[...global.prefsCheckNames,"pdfTitleFn"],global.sourceExtras={springer:{types:["chapter","article","book","referenceworkentry"]}},global.preprintSources=["arxiv","biorxiv"],global.knownPaperPages={acl:{patterns:["aclanthology.org/"],name:"ACL Anthology (Association for Computational Linguistics)"},acm:{patterns:["dl.acm.org/doi/"],name:"ACM (Association for Computing Machinery)"},aps:{patterns:[e=>Boolean(e.match(/journals\.aps\.org\/\w+\/(abstract|pdf)\//g))],name:"APS (American Physical Society)"},acs:{patterns:["pubs.acs.org/doi/"],name:"ACS (American Chemical Society)"},arxiv:{patterns:["arxiv.org/abs/","arxiv.org/pdf/","scirate.com/arxiv/","ar5iv.labs.arxiv.org/html/","alphaxiv.org/abs/","alphaxiv.org/pdf/",e=>e.includes("huggingface.co/papers/")&&e.split("huggingface.co/papers/")[1].match(/\d+\.\d+/)],name:"ArXiv"},biorxiv:{patterns:["biorxiv.org/content"],name:"BioRxiv"},cell:{patterns:[e=>e.includes("cell.com/")&&e.split("cell.com/")[1].match(/\d{4}-\d{3}[0-9X]/)],name:"Cell"},chemrxiv:{patterns:["chemrxiv.org/engage/chemrxiv/article-details/",e=>e.includes("https://chemrxiv.org/engage/api-gateway/chemrxiv/assets")&&e.endsWith(".pdf")],name:"ChemRxiv"},cvf:{patterns:["openaccess.thecvf.com/content"],name:"CVF (Computer Vision Foundation)"},frontiers:{patterns:["frontiersin.org/articles"],name:"Frontiers"},hal:{patterns:[e=>/hal\.science\/\w+-\d+(v\d+)?(\/document)?$/gi.test(e),e=>/hal\.science\/\w+-\d+(v\d+)?\/file\/.+\.pdf$/gi.test(e)],name:"HAL"},ihep:{patterns:["inspirehep.net/literature/","inspirehep.net/files/"],name:"IHEP (INSPIRE - High Energy Physics)"},ijcai:{patterns:[e=>/ijcai\.org\/proceedings\/\d{4}\/\d+/gi.test(e)],name:"IJCAI (International Joint Conferences on Artificial Intelligence)"},ieee:{patterns:["ieeexplore.ieee.org/document/","ieeexplore.ieee.org/abstract/document/","ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber="],name:"IEEE (Institute of Electrical and Electronics Engineers)"},iop:{patterns:["iopscience.iop.org/article/"],name:"IOP (Institute Of Physics)"},jmlr:{patterns:[e=>e.includes("jmlr.org/papers/v")&&!e.endsWith("/")],name:"JMLR (Journal of Machine Learning Research)"},mdpi:{patterns:[e=>/mdpi\.com\/\d+-.+/gi.test(e)],name:"MDPI (Multidisciplinary Digital Publishing Institute)"},nature:{patterns:["nature.com/articles/"],name:"Nature"},neurips:{patterns:["neurips.cc/paper/","neurips.cc/paper_files/paper/","nips.cc/paper/","nips.cc/paper_files/paper/"],name:"NeurIPS (Neural Information Processing Systems)"},openreview:{patterns:["openreview.net/forum","openreview.net/pdf","openreview.net/attachment"],name:"OpenReview"},oup:{patterns:[e=>0<=(e.split("https://academic.oup.com/")[1]?.split("/")[1]?.indexOf("article")??-1)],name:"OUP (Oxford University Press)"},plos:{patterns:[e=>/journals\.plos\.org\/.+\/article.+id=/gi.test(e)],name:"PLOS (Public Library of Science)"},pmc:{patterns:["ncbi.nlm.nih.gov/pmc/articles/PMC"],name:"PMC (PubMed Central)"},pmlr:{patterns:["proceedings.mlr.press/"],name:"PMLR (Proceedings of Machine Learning Research)"},pnas:{patterns:["pnas.org/content/","pnas.org/doi/"],name:"PNAS (Proceedings of the National Academy of Sciences)"},rsc:{patterns:["pubs.rsc.org/en/content/article"],name:"RSC (Royal Society of Chemistry)"},science:{patterns:[e=>Boolean(e.match(/science\.org\/doi\/?(abs|full|pdf|epdf)?\//g))],name:"Science"},sciencedirect:{patterns:["sciencedirect.com/science/article/pii/","sciencedirect.com/science/article/abs/pii/","reader.elsevier.com/reader/sd/pii/"],name:"ScienceDirect"},springer:{patterns:[...global.sourceExtras.springer.types.map(e=>`link.springer.com/${e}/`),"link.springer.com/content/pdf/"],name:"Springer"},website:{patterns:[],name:"Manually parsed website"},wiley:{patterns:[e=>Boolean(e.match(/onlinelibrary\.wiley\.com\/doi\/(abs\/|full\/|pdf\/|epdf\/|10\.)/g))],name:"Wiley"},aip:{patterns:[e=>e.match(/pubs.aip.org\/aip\/.+\/(article|article-abstract|article-split)\//g)||e.match(/watermark.silverchair.com\/.+\.pdf/g)],name:"AIP (American Institute of Physics)"}},global.overrideORConfs={"robot-learning":"CoRL",ijcai:"IJCAI"},global.overridePMLRConfs={"Conference on Learning Theory":"CoLT","International Conference on Machine Learning":"ICML","Conference on Uncertainty in Artificial Intelligence":"UAI","Conference on Robot Learning":"CoRL","International Conference on Artificial Intelligence and Statistics":"AISTATS","International Conference on Algorithmic Learning Theory":"ALT"},global.overrideDBLPVenues={"J. Mach. Learn. Res.":"JMLR"},global.consolHeaderStyle="@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300');font-family:'Fira Code' monospace;font-size:1rem;font-weight:300;display:inline-block;border:2px solid #A41716;border-radius: 4px;padding: 12px; margin: 12px;",global.storeReadme=`
/!\\ Warning: This folder has been created automatically by your PaperMemory browser extension.

/!\\ It has to stay in your downloads for PaperMemory to be able to access your papers.

/!\\ To be able to open files from this folder instead of re-downloading them, PaperMemory will match their titles and downloaded urls.

/!\\ If you change the default title function in the Advanced Options and do not include a paper's title in the file name, PaperMemory may not be able to open the file and will instead open the pdf url.

/!\\ Unfortunately, PaperMemory cannot detect papers that have not been *downloaded there* so putting papers in this folder will not make them discoverable by the \`browser.downloads\` API PaperMemory uses.
`,global.englishStopWords=new Set(["i","me","my","myself","we","our","ours","ourselves","you","your","yours","yourself","yourselves","he","him","his","himself","she","her","hers","herself","it","its","itself","they","them","their","theirs","themselves","what","which","who","whom","this","that","these","those","am","is","are","was","were","be","been","being","have","has","had","having","do","does","did","doing","a","an","the","and","but","if","or","because","as","until","while","of","at","by","for","with","about","against","between","into","through","during","before","after","above","below","to","from","up","down","in","out","on","off","over","under","again","further","then","once","here","there","when","where","why","how","all","any","both","each","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very","s","t","can","will","just","don","should","now"]),global.journalAbbreviations=null,global.notif={timeout:null,prevent:!1,showSpeed:400,displayDuration:3e3,hideSpeed:400,element:null,isLoading:!1},"undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={state:global.state,descendingSortKeys:global.descendingSortKeys,svgActionsHoverTitles:global.svgActionsHoverTitles,select2Options:global.select2Options,prefsCheckNames:global.prefsCheckNames,prefsCheckDefaultFalse:global.prefsCheckDefaultFalse,prefsStorageKeys:global.prefsStorageKeys,sourceExtras:global.sourceExtras,preprintSources:global.preprintSources,knownPaperPages:global.knownPaperPages,overrideORConfs:global.overrideORConfs,overridePMLRConfs:global.overridePMLRConfs,overrideDBLPVenues:global.overrideDBLPVenues,consolHeaderStyle:global.consolHeaderStyle,storeReadme:global.storeReadme,englishStopWords:global.englishStopWords,journalAbbreviations:global.journalAbbreviations});let safeRemoveSurroundingBraces=e=>{let t=0,a=0,r=!0;for(var o of e.slice(1,-1))if("{"===o&&t++,"}"===o&&a++,a>t){r=!1;break}return r?e.slice(1,-1):e},bibtexToObject=e=>{var t,a,r=new BibtexParser,e=(e=e.replaceAll(/,\s?(\w+)=(\w+)(\s?,?)/gi,", $1={$2}$3"),r.setInput(e),r.bibtex(),r.getEntries()[0]),o={...e.entryTags,entryType:e.entryType,citationKey:e.citationKey};for([t,a]of Object.entries(o))a.startsWith("{")&&a.endsWith("}")&&(o[t]=safeRemoveSurroundingBraces(a)),t===t.toUpperCase()&&(o[t.toLowerCase()]=o[t],delete o[t]);return o},bibtexToString=t=>{let a=`@${(t={...t=(t="string"==typeof t?bibtexToObject(t):t).hasOwnProperty("entryTags")?{...t.entryTags,entryType:t.entryType,citationKey:t.citationKey}:t}).entryType.toLowerCase()}{${t.citationKey},
`;delete t.entryType,delete t.citationKey;var r,o,i=Math.max(...Object.keys(t).map(e=>e.length));for(r in t)if(t.hasOwnProperty(r)&&t[r]){let e=t[r].replaceAll(/\s+/g," ").trim();0<(e=e.startsWith("{")&&e.endsWith("}")?safeRemoveSurroundingBraces(e):e).length&&(o=r+" ".repeat(i-r.length),a+=`	${o} = {${e}},
`)}return(a.slice(0,-2)+"\n}").replaceAll("\t","  ").replaceAll("--","-")},extractBibtexValue=(e,t)=>{e=bibtexToObject(e);return e.hasOwnProperty(t)?e[t]:""},extractAuthor=e=>extractBibtexValue(e,"author").replaceAll("{","").replaceAll("}","").replaceAll("\\","").split(" and ").map(e=>e.split(", ").reverse().join(" ")).join(" and "),logTrace=("undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={BibtexParser:BibtexParser,safeRemoveSurroundingBraces:safeRemoveSurroundingBraces,bibtexToObject:bibtexToObject,bibtexToString:bibtexToString,extractBibtexValue:extractBibtexValue,extractAuthor:extractAuthor}),"undefined"!=typeof LOGTRACE&&LOGTRACE),log=(...e)=>{let t="%c%s ",a=!1,r=!1,o=!1,i=!1,n=!1;var s;"[info]"===e[0]?(a=!0,e=e.slice(1)):"[warn]"===e[0]?(r=!0,e=e.slice(1)):"[error]"===e[0]?(o=!0,e=e.slice(1)):"[ok]"===e[0]?(n=!0,e=e.slice(1)):"[debug]"===e[0]&&(i=!0,e=e.slice(1)),(o&&1<=logTrace||r&&2<=logTrace||a&&3<=logTrace||i&&4<=logTrace||5<=logTrace)&&(s=(new Error).stack,e.push("\n\nLog trace:\n"+s.split("\n").slice(2).join("\n"))),e.forEach(e=>{switch(typeof e){case"bigint":case"number":t+="%d   ";break;case"string":t+="%s   ";break;default:t+="%o   "}}),console.log(t,"color: "+(a?"#8BB4F7; font-weight:bold;":r?"#f3bd1e; font-weight:bold;":o?"#FF4F54; font-weight:bold;":n?"#23F62B; font-weight:bold;":i?"#BA357E; font-weight:bold;":"tan"),"[PM]",...e)},info=(...e)=>log("[info]",...e),warn=(...e)=>log("[warn]",...e),debug=(...e)=>log("[debug]",...e),logOk=(...e)=>log("[ok]",...e),logError=(...e)=>log("[error]",...e),consoleHeader=e=>console.groupCollapsed("%c"+e,global.consolHeaderStyle),getDisplayId=e=>{var t=e;return(e=e.split("_")[0].split(".")[0]).startsWith("OR-")||(e=e.split("-").slice(0,2).join("-")),global.state.papers.hasOwnProperty(t)&&("nature"===(t=global.state.papers[t]).source&&(t.note.match(/^Published\ @.+\(\d+\)$/)&&(e+="-"+t.note.split("@")[1].split("(")[0].trim().split(" ").map(e=>e[0].toUpperCase()).join("")),e.includes(t.year+"")||(e+="-"+t.year)),"acs"!==t.source||e.includes(t.year+"")||(e+="-"+t.year),"iop"!==t.source||e.includes(t.year+"")||(e+="-"+t.year)),e},isObject=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e,isPdfUrl=e=>e.endsWith(".pdf")||e.endsWith("/pdf")||e.includes("openreview.net/pdf")||e.match(/\/e?pdf\//g)||e.includes("ieee.org/stamp/stamp.jsp?tp=&arnumber=")||e.includes("articlepdf");function delay(t,a){let r=0;return function(...e){clearTimeout(r),r=setTimeout(t.bind(this,...e),a||0)}}let cleanPapers=e=>{let t={...e};return Object.keys(t).forEach(e=>{e.startsWith("__")&&delete t[e]}),t},firstNonStopLowercase=e=>{var e=e.toLowerCase().split(" ").map(miniHash),t=e.filter(e=>!global.englishStopWords.has(e));return(0<t.length?t:e)[0]},miniHash=(e,t)=>(void 0===t&&(t=""),e.toLowerCase().replace(/\W/g,t)),fallbackCopyTextToClipboard=e=>{var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var a=document.execCommand("copy")?"successful":"unsuccessful";log("Fallback: Copying text command was "+a)}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)},copyTextToClipboard=e=>{navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{log("Async: Copying to clipboard was successful!")},e=>{console.error("Async: Could not copy text: ",e)}):fallbackCopyTextToClipboard(e)};async function pasteRich(t,a){var e,r;"undefined"!=typeof ClipboardItem?(e=new Blob([t],{type:"text/html"}),r=new Blob([a],{type:"text/plain"}),e=new ClipboardItem({"text/html":e,"text/plain":r}),await navigator.clipboard.write([e])):(r=e=>{e.clipboardData.setData("text/html",t),e.clipboardData.setData("text/plain",a),e.preventDefault()},document.addEventListener("copy",r),document.execCommand("copy"),document.removeEventListener("copy",r))}let copyHyperLinkToClipboard=(e,t)=>{pasteRich(`<a href="${e}">${t}</a>`,t+" "+e)},parseUrl=e=>{var t=document.createElement("a");return t.href=e,t},downloadTextFile=(e,t,a)=>{var r=document.createElement("a");"text/plain"===a?(e=e.replace(/\\n/g,"%0D%0A").replace(/"/g,""),r.download=t,r.href="data:text/plain,"+e):(e=new Blob([e],{type:a}),r.href=URL.createObjectURL(e),r.download=t),r.click()},dummyEvent=e=>({target:{closest:()=>({id:"memory-container--"+e})}}),eventId=e=>e.target.closest(".memory-container")?.id?.split("--")[1];async function downloadURI(e,a){a=a.replace(/[^\w\s]/gi,"");var e=await fetch(e).then(e=>e.blob()),t=new FileReader;t.readAsDataURL(e),t.onload=e=>{var e=e.target.result,t=document.createElement("a");t.download=a,t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}}let downloadFile=(e,t)=>{var a;window.ActiveXObject?(window.ActiveXObject,document.execCommand&&((a=window.open(e,"_blank")).document.close(),a.document.execCommand("SaveAs",!0,t||e),a.close())):((a=document.createElement("a")).href=e,a.target="_blank",a.download=t,navigator.userAgent.toLowerCase().match(/(ipad|iphone|safari)/)&&navigator.userAgent.search("Chrome")<0?document.location=a.href:(e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}),a.dispatchEvent(e),(window.URL||window.webkitURL).revokeObjectURL(a.href)))},hashCode=e=>e.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0),parseCVFUrl=e=>{var t=e.replace("https://openaccess.thecvf.com/content","").slice(1).split("/")[0].split("_");let a,r;r=1===t.length?(a=t[0].slice(0,-4),t[0].slice(-4)):(a=t[0].toUpperCase(),t[1]);t=e.split("/").last().split(".")[0],e=(hashCode(t)+"").replace("-","").slice(0,8),t=`${a}-${r}_`+e;return{conf:a,year:r,id:t}},cleanBiorxivURL=e=>e=(e=e.replace(".full.pdf","")).match(/\d$/)?e:e.split(".").slice(0,-1).join("."),textareaFocusEnd=e=>{setTimeout(()=>{e.selectionStart=e.selectionEnd=1e4},0)},tablerSvg=(e,t,a)=>{switch(t=(t=void 0===t?"":t)&&`id="${t}"`,a=(a=(a=void 0===a?[]:a).filter(e=>e))&&`class="${a.join(" ")}"`,e){case"adjustments":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="6" cy="10" r="2" />
            <line x1="6" y1="4" x2="6" y2="8" />
            <line x1="6" y1="12" x2="6" y2="20" />
            <circle cx="12" cy="16" r="2" />
            <line x1="12" y1="4" x2="12" y2="14" />
            <line x1="12" y1="18" x2="12" y2="20" />
            <circle cx="18" cy="7" r="2" />
            <line x1="18" y1="4" x2="18" y2="5" />
            <line x1="18" y1="9" x2="18" y2="20" />
            </svg>`;case"circle-x":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="12" cy="12" r="9" />
            <path d="M10 10l4 4m0 -4l-4 4" />
            </svg>`;case"star":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" />
            </svg>`;case"writing":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z" />
            <path d="M16 7h4" />
            <path d="M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3" />
            </svg>`;case"file-symlink":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M4 21v-4a3 3 0 0 1 3 -3h5" />
            <path d="M9 17l3 -3l-3 -3" />
            <path d="M14 3v4a1 1 0 0 0 1 1h4" />
            <path d="M5 11v-6a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-9.5" />
            </svg>`;case"link":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
            <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
            </svg>`;case"clipboard-list":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2" />
            <rect x="9" y="3" width="6" height="4" rx="2" />
            <line x1="9" y1="12" x2="9.01" y2="12" />
            <line x1="13" y1="12" x2="15" y2="12" />
            <line x1="9" y1="16" x2="9.01" y2="16" />
            <line x1="13" y1="16" x2="15" y2="16" />
            </svg>`;case"archive":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <rect x="3" y="4" width="18" height="4" rx="2" />
            <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
            <line x1="10" y1="12" x2="14" y2="12" />
            </svg>`;case"external-link":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M11 7h-5a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-5" />
            <line x1="10" y1="14" x2="20" y2="4" />
            <polyline points="15 4 20 4 20 9" />
            </svg>`;case"file-download":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M14 3v4a1 1 0 0 0 1 1h4" />
            <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
            <line x1="12" y1="11" x2="12" y2="17" />
            <polyline points="9 14 12 17 15 14" />
             </svg>`;case"circle-x":return`<svg viewBox="0 0 24 24" ${t} ${a}>
			<path stroke="none" d="M0 0h24v24H0z" fill="none" />
			<circle cx="12" cy="12" r="9" />
			<path d="M10 10l4 4m0 -4l-4 4" />
		    </svg>`;case"settings":return`<svg viewBox="0 0 24 24" ${t} ${a}>
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
            <circle cx="12" cy="12" r="3" />
            </svg>`;case"messages":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M21 14l-3 -3h-7a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1h9a1 1 0 0 1 1 1v10" />
                <path d="M14 15v2a1 1 0 0 1 -1 1h-7l-3 3v-10a1 1 0 0 1 1 -1h2" />
            </svg>`;case"ar5iv":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M12 2l.642 .005l.616 .017l.299 .013l.579 .034l.553 .046c4.687 .455 6.65 2.333 7.166 6.906l.03 .29l.046 .553l.041 .727l.006 .15l.017 .617l.005 .642l-.005 .642l-.017 .616l-.013 .299l-.034 .579l-.046 .553c-.455 4.687 -2.333 6.65 -6.906 7.166l-.29 .03l-.553 .046l-.727 .041l-.15 .006l-.617 .017l-.642 .005l-.642 -.005l-.616 -.017l-.299 -.013l-.579 -.034l-.553 -.046c-4.687 -.455 -6.65 -2.333 -7.166 -6.906l-.03 -.29l-.046 -.553l-.041 -.727l-.006 -.15l-.017 -.617l-.004 -.318v-.648l.004 -.318l.017 -.616l.013 -.299l.034 -.579l.046 -.553c.455 -4.687 2.333 -6.65 6.906 -7.166l.29 -.03l.553 -.046l.727 -.041l.15 -.006l.617 -.017c.21 -.003 .424 -.005 .642 -.005zm2 5h-4a1 1 0 0 0 -.993 .883l-.007 .117v4a1 1 0 0 0 .883 .993l.117 .007h3v2h-2l-.007 -.117a1 1 0 0 0 -1.993 .117a2 2 0 0 0 1.85 1.995l.15 .005h2a2 2 0 0 0 1.995 -1.85l.005 -.15v-2a2 2 0 0 0 -1.85 -1.995l-.15 -.005h-2v-2h3a1 1 0 0 0 .993 -.883l.007 -.117a1 1 0 0 0 -.883 -.993l-.117 -.007z" stroke-width="0" fill="#7c7f8b"></path>
            </svg>`;case"vocabulary":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M10 19h-6a1 1 0 0 1 -1 -1v-14a1 1 0 0 1 1 -1h6a2 2 0 0 1 2 2a2 2 0 0 1 2 -2h6a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-6a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2z" />
                <path d="M12 5v16" />
                <path d="M7 7h1" />
                <path d="M7 11h1" />
                <path d="M16 7h1" />
                <path d="M16 11h1" />
                <path d="M16 15h1" />
            </svg>`;case"database-export":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <ellipse cx="12" cy="6" rx="8" ry="3" />
                <path d="M4 6v6c0 1.657 3.582 3 8 3a19.84 19.84 0 0 0 3.302 -.267m4.698 -2.733v-6" />
                <path d="M4 12v6c0 1.599 3.335 2.905 7.538 2.995m8.462 -6.995v-2m-6 7h7m-3 -3l3 3l-3 3" />
            </svg>`;case"eyeglass":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M8 4h-2l-3 10" />
                <path d="M16 4h2l3 10" />
                <line x1="10" y1="16" x2="14" y2="16" />
                <path d="M21 16.5a3.5 3.5 0 0 1 -7 0v-2.5h7v2.5" />
                <path d="M10 16.5a3.5 3.5 0 0 1 -7 0v-2.5h7v2.5" />
            </svg>`;case"markdown":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <rect x="3" y="5" width="18" height="14" rx="2" />
                <path d="M7 15v-6l2 2l2 -2v6" />
                <path d="M14 13l2 2l2 -2m-2 2v-6" />
            </svg>`;case"math-function":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M14 10h1c1 0 1 1 2.016 3.527c.984 2.473 .984 3.473 1.984 3.473h1" />
                <path d="M13 17c1.5 0 3 -2 4 -3.5s2.5 -3.5 4 -3.5" />
                <path d="M3 19c0 1.5 .5 2 2 2s2 -4 3 -9s1.5 -9 3 -9s2 .5 2 2" />
                <line x1="5" y1="12" x2="11" y2="12" />
            </svg>`;case"device-desktop-code":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <path d="M12.5 16h-8.5a1 1 0 0 1 -1 -1v-10a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v8"></path>
                <path d="M7 20h4"></path>
                <path d="M9 16v4"></path>
                <path d="M20 21l2 -2l-2 -2"></path>
                <path d="M17 17l-2 2l2 2"></path>
            </svg>`;case"info-square-rounded":return`<svg viewBox="0 0 24 24" ${t} ${a}>
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M12 9h.01" /><path d="M11 12h1v4h1" />
                <path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z" />
            </svg>`;case"huggingface":return`<img
                src="${chrome.runtime.getURL(global.state.prefs.checkDarkMode?"src/shared/hf-logo-transparent-darktheme.svg":"src/shared/hf-logo-transparent-lighttheme.svg")}"
                ${t}
                ${a}
            >`;case"alphaxiv":return`
            <svg viewBox="0 0 718.41 504.47" ${t} ${a}>
                <polygon points="591.15 258.54 718.41 385.73 663.72 440.28 536.57 313.62 591.15 258.54"></polygon>
                <path d="M273.86.3c34.56-2.41,67.66,9.73,92.51,33.54l94.64,94.63-55.11,54.55-96.76-96.55c-16.02-12.7-37.67-12.1-53.19,1.11L54.62,288.82,0,234.23,204.76,29.57C223.12,13.31,249.27,2.02,273.86.3Z"></path>
                <path d="M663.79,1.29l54.62,54.58-418.11,417.9c-114.43,95.94-263.57-53.49-167.05-167.52l160.46-160.33,54.62,54.58-157.88,157.77c-33.17,40.32,18.93,91.41,58.66,57.48L663.79,1.29Z"></path>
            </svg>`;default:return""}},stringifyError=e=>{let t=chrome.runtime.id;return e.stack.split("\n").map(e=>e.split(" ").map(e=>e.split(t).last()).join(" ")).join("<br/>")},arraysIdentical=(e,t)=>{var a=e.length;if(a!=t.length)return!1;for(;a--;)if(e[a]!==t[a])return!1;return!0},parseTags=e=>{e=Array.from(e.selectedOptions,e=>e.value.trim()).filter(e=>e);return e.sort(),e},getPaperEdits=(e,t)=>{let a,r,o,i;return i=t?(a=val("popup-form-note-textarea--"+e),o=val(document.getElementById("popup-form-note--"+e).querySelector(".form-code-input")),r=parseTags(findEl({element:"popup-item-tags--"+e})),findEl({element:"checkFavorite--"+e}).checked):(a=val(findEl({paperId:e,memoryItemClass:"form-note-textarea"})),o=val(findEl({paperId:e,memoryItemClass:"form-code-input"})),r=parseTags(findEl({paperId:e,memoryItemClass:"memory-item-tags"})),hasClass("memory-container--"+e,"favorite")),{note:a,tags:r,codeLink:o,favorite:i}},setFormChangeListener=(e,t)=>{let a,r,o,i;t?(a="#popup-item-tags--"+e.replace(".","\\."),o="popup-form-codeLink--"+e,r="popup-form-note-textarea--"+e,i="checkFavorite--"+e,$(a).on("change",delay(monitorPaperEdits(e,t),300)),addListener(o,"keyup",delay(monitorPaperEdits(e,t),300)),addListener(r,"keyup",delay(monitorPaperEdits(e,t),300)),addListener(i,"change",delay(monitorPaperEdits(e,t),300))):(a=".memory-item-tags",o=".form-code-input",r=".form-note-textarea",addEventToClass(o,"keyup",delay(monitorPaperEdits(void 0,t),300)),addEventToClass(r,"keyup",delay(monitorPaperEdits(void 0,t),300)))},monitorPaperEdits=(l,p)=>e=>{let t;t=void 0===l?eventId(e):l;var a=getPaperEdits(t,p),r=global.state.papers[t];let o=!1;for(var i in a){var n=r[i],s=(i,a[i]);"tags"===i?arraysIdentical(n,s)||(o=!0):n!==s&&(o=!0)}o&&(console.log("Updating meta data for",t),(p?handlePopupSaveEdits:handleMemorySaveEdits)(t))},cutAuthors=(e,t,a)=>{void 0===t&&(t=140),void 0===a&&(a=", ");let r="";var o,i,n=e.split(" and "),s=n[n.length-1];for([o,i]of n.entries()){if(!(5+r.length+a.length+i.length+s.length<t||o==n.length-1)){r+=" <span class='expand-paper-authors'>...</span> "+s;break}i.includes(",")&&(i=i.split(",").map(e=>e.trim()).reverse().join(" ")),r?r+=", "+i:r=i}return r},sendMessageToBackground=e=>new Promise(t=>{chrome.runtime.sendMessage(e,e=>{t(e)})}),getStoredFiles=()=>new Promise(t=>{chrome.downloads.search({filenameRegex:"(PaperMemoryStore/)?.*.pdf"},e=>t(e.filter(e=>e.exists&&"complete"===e.state&&!e.filename.toLowerCase().includes("readme.txt"))))}),noParamUrl=e=>e.split("?")[0].split("#")[0],urlToWebsiteId=e=>{var t;return e.split("/").last().includes("#")&&(t=e.split("#").length-1,e=e.split("#").slice(0,t).join("#")),miniHash(e.replace("https://","").replace("http://","").replace("www.",""))},silentPromiseTimeout=(e,a=2e3)=>{let r;return Promise.race([e,new Promise((e,t)=>r=setTimeout(e,a))]).finally(()=>clearTimeout(r))},shouldWarn=async(e,t=()=>{})=>t(!1),spaceCamelCase=e=>e.replace(/([A-Z](?=[a-z]+)|[A-Z]+(?![a-z]))/g," $1").trim(),toSingleSpace=e=>e.replace(/\s\s+/g," "),dedent=e=>(""+e).replace(/(\n)\s+/g,"$1"),arxivIdFromPaperID=e=>e.split("-").last().replace("_","/"),cleanStr=e=>e.replace(/[^a-zA-Z0-9 ]/g,""),arxivIdFromURL=e=>e.includes("scirate.com/arxiv/")?e.split("scirate.com/arxiv/")[1].match(/\d+\.\d+/)[0]:e.match(/alphaxiv\.org\/(abs|pdf)\//)?e.split("alphaxiv.org/")[1].match(/\d+\.\d+/)[0]:e.includes("ar5iv.labs.arxiv.org/html/")?e.split("ar5iv.labs.arxiv.org/html/")[1].match(/\d+\.\d+/)[0]:e.includes("huggingface.co/papers/")?e.split("huggingface.co/papers/")[1].match(/\d+\.\d+/)[0]:noParamUrl(e).replace("/abs/","/pdf/").split("/pdf/")[1].replace(".pdf","").split("v")[0].replace("/","_"),getBrowserName=async()=>{let e=navigator.appName;var t=navigator.userAgent;return-1!=(verOffset=t.indexOf("OPR"))?e="Opera":navigator.brave&&await navigator.brave.isBrave()?e="Brave":-1!=(verOffset=t.indexOf("Edg"))?e="Microsoft Edge":-1!=(verOffset=t.indexOf("MSIE"))?e="Microsoft Internet Explorer":-1!=(verOffset=t.indexOf("Chrome"))?e="Chrome":-1!=(verOffset=t.indexOf("Safari"))?e="Safari":-1!=(verOffset=t.indexOf("Firefox"))&&(e="Firefox"),e};function getRandomToken(){for(var e=new Uint8Array(32),t=(crypto.getRandomValues(e),""),a=0;a<e.length;++a)t+=e[a].toString(16);return t}"undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={logTrace:logTrace,log:log,info:info,warn:warn,debug:debug,logOk:logOk,logError:logError,consoleHeader:consoleHeader,getDisplayId:getDisplayId,isObject:isObject,isPdfUrl:isPdfUrl,cleanPapers:cleanPapers,firstNonStopLowercase:firstNonStopLowercase,miniHash:miniHash,fallbackCopyTextToClipboard:fallbackCopyTextToClipboard,copyTextToClipboard:copyTextToClipboard,copyHyperLinkToClipboard:copyHyperLinkToClipboard,parseUrl:parseUrl,downloadTextFile:downloadTextFile,eventId:eventId,downloadFile:downloadFile,downloadURI:downloadURI,hashCode:hashCode,parseCVFUrl:parseCVFUrl,cleanBiorxivURL:cleanBiorxivURL,textareaFocusEnd:textareaFocusEnd,tablerSvg:tablerSvg,stringifyError:stringifyError,arraysIdentical:arraysIdentical,parseTags:parseTags,getPaperEdits:getPaperEdits,setFormChangeListener:setFormChangeListener,monitorPaperEdits:monitorPaperEdits,cutAuthors:cutAuthors,sendMessageToBackground:sendMessageToBackground,getStoredFiles:getStoredFiles,noParamUrl:noParamUrl,urlToWebsiteId:urlToWebsiteId,silentPromiseTimeout:silentPromiseTimeout,shouldWarn:shouldWarn,spaceCamelCase:spaceCamelCase,toSingleSpace:toSingleSpace,dedent:dedent,arxivIdFromPaperID:arxivIdFromPaperID,cleanStr:cleanStr,arxivIdFromURL:arxivIdFromURL,getBrowserName:getBrowserName});let getPat=async e=>{var t=await getStorage("syncPAT");if(!t&&(warn("No PAT found. Aborting and disabling sync."),await setStorage("syncState",!1),e))throw new Error("No PAT found.");return t},getIdentifier=async()=>{var e=await getBrowserName();let t=await getStorage("syncId");return t||(t=e+"-"+(t=getRandomToken()),info("No syncId found. Creating new one: ",t),await setStorage("syncId",t)),t},getGist=async({pat:r,store:o=!0,patError:i=!0})=>{try{r=r||await getPat(i);let t=await getStorage("syncTest")?"TestsPaperMemorySync":"DO_NO_EDIT__PaperMemorySyncV2.json",a="Automated PaperMemory sync Gist. Do not edit manually.",e=(await octokitRequest.defaults({headers:{authorization:"token "+r,"X-GitHub-Api-Version":"2022-11-28"}})("GET /gists")).data?.find(e=>e.description===a&&e.files[t]);if(!e){info("No Gist found. Creating new one...");var n=await getStorage("papers");if(!(e=await createGistWithFile({file:t,pat:r,description:a,content:n})))return{ok:!1,payload:"wrongPAT"}}file=e.files[t];var s=e.id;return o&&await setStorage("syncPAT",r),{ok:!0,payload:{file:file,pat:r,gistId:s}}}catch(e){return console.log(e),warn("Because of the error ^ syncing is now disabled."),setStorage("syncState",!1),{ok:!1,payload:"wrongPAT",error:e}}},createGistWithFile=async({file:e,pat:t,content:a,description:r="Automated PaperMemory sync Gist. Do not edit manually."})=>{if(void 0===e)throw new Error("No file provided.");return"string"!=typeof a&&(a=JSON.stringify(a,null,"")),"string"==typeof e&&(e={filename:e}),t=t||await getPat(),(await octokitRequest.defaults({headers:{authorization:"token "+t,"X-GitHub-Api-Version":"2022-11-28"}})("POST /gists",{description:r,files:{[e.filename]:{content:a}},public:!1})).data},getDataForGistFile=async({file:t,pat:e,gistId:a})=>{"string"==typeof t&&(t={filename:t}),e=e||await getPat();var r,e=octokitRequest.defaults({headers:{authorization:"token "+e,"X-GitHub-Api-Version":"2022-11-28"}});let o;return o=a?(await e("GET /gists/"+a)).data:(await e("GET /gists")).data?.find(e=>e.files[t.filename]),(t=o.files[t.filename]).filename.endsWith(".json")?({data:a,status:r}=await fetchJSON(t.raw_url),a):fetchText(t.raw_url)},updateGistFile=async({file:e,content:t,gistId:a,pat:r})=>(r=r||await getPat(),"string"!=typeof t&&(t=JSON.stringify(t,null,"")),"string"==typeof e&&(e={filename:e}),octokitRequest.defaults({headers:{authorization:"token "+r,"X-GitHub-Api-Version":"2022-11-28"}})("PATCH /gists/"+a,{files:{[e.filename]:{content:t}}})),pushToRemote=async()=>sendMessageToBackground({type:"writeSync"}),pullFromRemote=async(e,t)=>{var a=Date.now(),r=await sendMessageToBackground({type:"pullSync"});return consoleHeader("PaperMemory Pull "+String.fromCodePoint("0x1F504")),log("Remote Papers pulled: ",r),r&&(await initState({isContentScript:t,papers:r??e,print:!1}),t=(Date.now()-a)/1e3,info(`Successfully pulled from Github (${t}s).`),await setStorage("papers",global.state.papers)),console.groupEnd(),r},shouldSync=async()=>!!await getStorage("syncState"),initSyncAndState=async({papers:e=null,isContentScript:t=!1,forceInit:a=!1,stateIsReady:r=()=>{},remoteIsReady:o=()=>{}}={})=>{global.state.dataVersion&&!a||await initState({papers:e,isContentScript:t}),r(),await shouldSync()&&(t||startSyncLoader(),await pullFromRemote(e,t)?t||(a=global.state.sortedPapers.length,setPlaceholder("memory-search",`Search ${a} entries...`),global.state.memoryIsOpen||window.location.href.includes("options.html")||await makeMemoryHTML(),successSyncLoader()):t||errorSyncLoader()),o()},startSyncLoader=async()=>{showId("sync-popup-feedback"),hideId("sync-popup-error"),hideId("sync-popup-synced"),showId("sync-popup-syncing","flex")},successSyncLoader=async()=>{showId("sync-popup-feedback"),hideId("sync-popup-syncing"),hideId("sync-popup-error"),showId("sync-popup-synced"),setTimeout(()=>{hideId("sync-popup-feedback")},2e3)},errorSyncLoader=async()=>{showId("sync-popup-feedback"),hideId("sync-popup-syncing"),hideId("sync-popup-synced"),showId("sync-popup-error"),setTimeout(()=>{hideId("sync-popup-feedback")},2e3)},deleteGist=async({gistId:e,pat:t})=>(t=t||await getPat(),octokitRequest.defaults({headers:{authorization:"token "+t,"X-GitHub-Api-Version":"2022-11-28"}})("DELETE /gists/"+e)),sleep=async t=>new Promise(e=>setTimeout(e,t)),measureCacheTime=async({maxTime:a=1e5})=>{var r=`PaperMemory-cache-test-${Math.random().toString(36).substring(7)}.json`,o={test:"test",data:{counter:0}},i=await createGistWithFile({file:r,content:o,description:"PaperMemory cache test. You *can* delete this."}),n=(console.log("Test gist: ",i),i.id);try{var s=i.files[r],l=(o.data.counter++,await updateGistFile({file:s,content:o,gistId:n})),p=(console.log("updateResp: ",l),Date.now());let e,t=0;for(;;){var c=await getDataForGistFile({file:s,gistId:n});if(console.log(""),console.log("data: ",c),e=(Date.now()-p)/1e3,console.log("Time: ",e,"at iteration: ",t),1===c.data.counter)break;if(await sleep(500),e>a)break;t++}e>a?warn("Cache time too long: > maxTime=",a,"ms"):info(`Cache time: ${e}s`)}catch(e){console.log(e)}finally{info("Deleting test gist..."),await deleteGist({gistId:n})}},migrateData=("undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={getPat:getPat,getIdentifier:getIdentifier,getGist:getGist,createGistWithFile:createGistWithFile,getDataForGistFile:getDataForGistFile,updateGistFile:updateGistFile,pushToRemote:pushToRemote,pullFromRemote:pullFromRemote,shouldSync:shouldSync,initSyncAndState:initSyncAndState,startSyncLoader:startSyncLoader,successSyncLoader:successSyncLoader,errorSyncLoader:errorSyncLoader,deleteGist:deleteGist,sleep:sleep,measureCacheTime:measureCacheTime}),async(a,r,e=!0)=>{if(void 0===a)return chrome.storage.local.set({papers:{__dataVersion:r}}),{papers:{__dataVersion:r},success:!0};var o,i,n,s,l,p,c,d,u=a.__dataVersion||-1,h=[];let m={...a};try{if(1e4<=u)return log("No migration needed"),{papers:a,success:!0};e&&backupData({...a}),delete a.__dataVersion;let t={};for(var f in a){if(t[f]=[],u<5&&(a[f].hasOwnProperty("bibtex")||(a[f].bibtex="",t[f].push("(m5) bibtex default")),a[f].pdfLink.endsWith(".pdf")||(a[f].pdfLink=a[f].pdfLink+".pdf",t[f].push("(m5) pdfLink to .pdf")),a[f].codeLink||(a[f].codeLink="",t[f].push("(m5) codeLink default")),a[f].source||(a[f].id.includes("NeurIPS")?(a[f].source="neurips",t[f].push("(m5) NeurIPS to neurips")):(a[f].source="arxiv",t[f].push("(m5) source default is arxiv")))),u<208&&("arxiv"!==a[f].source&&a[f].md.includes("https://arxiv.com/abs/")&&(a[f].md=`[${a[f].title}](${a[f].pdfLink})`,t[f].push("(m208) md from title and pdfLink")),"arxiv"!==a[f].source&&a[f].pdfLink.includes("arxiv.org/pdf/")&&(a[f].source="arxiv",t[f].push("(m208) set arxiv source from pdfLink")),f.match(/^\d/))&&"arxiv"===a[f].source&&(o="Arxiv-"+f,i={...a[f],id:o},a[o]=i,h.push(f),t[f].push("(m208) new arxiv id to Arxiv-")),u<209&&(a[f].hasOwnProperty("favorite")||(a[f].favorite=!1,a[f].favoriteDate="",t[f].push("(m209) favorite defaults"))),u<210&&("arxiv"===a[f].source&&(n=a[f].pdfLink.match(/v\d+\.pdf/gi))&&0<n.length&&(a[f].pdfLink=a[f].pdfLink.replace(n[0],".pdf"),t[f].push("(m210) remove pdf version")),a[f].hasOwnProperty("bibtext"))&&(a[f].bibtex=a[f].bibtext+"",delete a[f].bibtext,t[f].push("(m210) bibtext typo to bibtex")),u<450&&!a[f].hasOwnProperty("venue"))try{a[f].venue=await makeVenue(a[f]),t[f].push("(m450) venue from id")}catch(e){logError(e),a[f].venue="",t[f].push("(m450) ERROR in venue from id")}if(u<502&&(f.startsWith("ACL-")&&"acl"!==a[f].source&&(a[f].source="acl",t[f].push("(m502) fix set source to acl")),"acs"===a[f].source)&&(a[f].pdfLink=a[f].pdfLink.replace("/doi/pdf/abs/","/doi/pdf/"),t[f].push("(m502) fix acs pdfLink")),u<510&&(a[f].venue?.toLowerCase().includes("arxiv")&&(a[f].venue="",a[f].note=a[f].note.replace(/accepted\s*@\s*arxiv\.org.+semanticscholar\.org\]/gi,"").trim(),t[f].push("(m509) fix: remove arxiv as venue")),!1===a[f].codeLink&&(a[f].codeLink="",t[f].push("(m509) codeLink from false to ''")),"string"!=typeof a[f].year&&(a[f].year=a[f].year+"",t[f].push("(m509) year to string"),"undefined"===a[f].year)&&(a[f].year="unknown",t[f].push("(m509) empty year to unknown")),void 0===a[f].venue)&&(a[f].venue="",t[f].push("(m509) venue undefined to ''")),u<513&&"iop"===a[f].source&&(l=(s=f).split("_")[1],p=s.split("_")[0]+"_"+miniHash(l),a[p]={...a[s]},h.push(s),t[f].push("(m513) iop doi-in-id to minihash")),u<1e4){if("acm"===a[f].source){let e=a[f].bibtex;var g=e.split("\n");g[0].includes("?")&&(g[0]=g[0].split("?")[0]+","),e=g.join("\n"),a[f].bibtex=e,t[f].push("(m10000) fix acm bibtex")}a[f].bibtex&&(c=bibtexToObject(a[f].bibtex))&&c.hasOwnProperty("abstract")&&(delete c.abstract,t[f].push("(m10000) remove bibtex abstract"),a[f].bibtex=bibtexToString(c))}u<1e4&&a[f].bibtex&&!a[f].hasOwnProperty("doi")&&(d=bibtexToObject(a[f].bibtex).doi)&&(a[f].doi=d,t[f].push("(m10001) add doi from bibtex"))}return h.forEach((e,t)=>{delete a[e],log("Deleting "+e)}),(m={...a}).__dataVersion=r,info("Migration summary:"),Object.keys(t).forEach(e=>{0<t[e].length&&log(e+":\n\t • "+t[e].join("\n\t • "))}),e&&chrome.storage.local.set({papers:m},()=>{log("Migrated papers:"),log(m),log("Data version is now "+r)}),{papers:m,success:!0}}catch(e){return log(`Error migrating data from version ${u} to ${r}: `),log(e),{papers:m,success:!1,error:e}}}),logStorage=t=>{chrome.storage.local.get(t,e=>{log(e[t])})},getStorage=async a=>new Promise((t,e)=>{chrome.storage.local.get(a,e=>{t("string"==typeof a?e[a]:e)})}),setStorage=async(a,r,o=()=>{})=>new Promise((e,t)=>{chrome.storage.local.set({[a]:r},()=>{o(),e(!0)})}),deletePaperInStorage=async(e,t)=>{let a=!1;(t=t||(await getStorage("papers")??{})).hasOwnProperty(e)&&(updateDuplicatedUrls(null,e,!0),a=(a=delete global.state.titleHashToIds[miniHash(t[e].title)])&&delete t[e],delete global.state.papers[e]),a?(await setStorage("papers",t),global.state.papersList=Object.values(cleanPapers(global.state.papers)),sortMemory(),log("Successfully deleted paper",e)):log("Error: no deletion")},getTheme=async()=>await getStorage("checkDarkMode")?"dark":"light",backupData=async a=>{chrome.storage.local.get("papersBackup",({papersBackup:e})=>{var t;void 0===e&&(e={});for(t of Object.keys(e).map(e=>parseInt(e)).sort((e,t)=>e<t?1:-1).slice(4))delete e[t];e[a.__dataVersion]=a,chrome.storage.local.set({papersBackup:e},()=>{log("Backed up data with version: "+a.__dataVersion)})})};function dateDiffInDays(e,t){e=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((t-e)/864e5)}let weeklyBackup=async()=>{var e=await getStorage("weeklyBackups")??{},t=new Date,a=Object.keys(e).map(e=>new Date(e)).sort((e,t)=>e.getTime()-t.getTime());if(0<a.length&&dateDiffInDays(a[a.length-1],t)<7)return;var r,o={};for(r of a.reverse().slice(0,5))o[r.toString()]=e[r.toString()];o[t.toString()]=await getStorage("papers")??{},setStorage("weeklyBackups",o)},getPrefs=async()=>{let e=!1,t;var a,r=await getStorage("prefs")??{},o=((e=0===Object.keys(r).length?!0:e)&&(t=await getStorage(global.prefsStorageKeys)??{}),{});for(a of global.prefsCheckNames)o[a]=(t??r).hasOwnProperty(a)?(t??r)[a]:!(0<=global.prefsCheckDefaultFalse.indexOf(a));return o.checkOfficialRepos&&(setStorage("pwcPrefs",{official:!0}),delete o.checkOfficialRepos,setStorage("prefs",o)),e&&setStorage("prefs",o),o},getDefaultKeyboardAction=async()=>{var e=await getStorage("defaultKeyboardAction");return e||(await setStorage("defaultKeyboardAction","o"),"o")},setDefaultKeyboardAction=async e=>setStorage("defaultKeyboardAction",e),getManifestDataVersion=()=>chrome.runtime.getManifest().version.split(".").map((e,t)=>parseInt(e)*10**(4-2*t)).reduce((e,t)=>e+t),versionToSemantic=e=>(e=(e-=1e4*(major=parseInt(e/1e4,10)))-100*(minor=parseInt(e/100,10)),`${major}.${minor}.`+e),validatePaper=(t,e=!0)=>{var a,r,o,i={addDate:{type:"string",desc:"the paper's date of addition to the Memory",default:e=>(new Date).toJSON(),validation:e=>{try{new Date(e)}catch(e){return`Invalid addDate (could not parse as date: ${e})`}}},author:{type:"string",desc:"` and `-separated authors `${firstName} ${lastName}`",validation:e=>{if(!e)throw Error(`No author: ${e} for paper ${t.id}:
${JSON.stringify(t,null,2)}
Fix the json file and try again.
`)}},bibtex:{type:"string",desc:"BibTex citation with new lines (`\n`)",validation:t=>{try{bibtexToObject(t)}catch(e){return`Invalid BibTex: ${e} :
`+t}}},code:{type:"object",desc:"the paper's code object as returned by the PapersWithCode API",default:e=>({})},codeLink:{type:"string",desc:"the paper's code link",default:e=>"",validation:t=>{try{parseUrl(t)}catch(e){return`Invalid codeLink (${t}): `+e}}},count:{type:"number",desc:"the paper's number of visits",default:e=>1,validation:e=>{if(e<0)return`Invalid count (${e}): must be >= 0`}},doi:{type:"string",desc:"the paper's doi",default:e=>bibtexToObject(e.bibtex).doi??""},extras:{type:"object",desc:"extra information about the paper which may be required per source",optional:!0},favorite:{type:"boolean",desc:"user wants to star the paper",default:e=>!1},favoriteDate:{type:"string",desc:"date the paper was added as a favorite",default:e=>""},id:{type:"string",desc:"Unique PaperMemory ID"},key:{type:"string",desc:"BibTex citation key",default:e=>"defaultKey_"+e.id},lastOpenDate:{type:"string",desc:"When the paper was last opened",default:e=>(new Date).toJSON()},md:{type:"string",desc:"markdown-formatted string `[${title}](${pdfLink})`",default:e=>`[${e.title}](${e.pdfLink})`},note:{type:"string",desc:"the user's note for this paper",default:e=>""},pdfLink:{type:"string",desc:"the link to the paper's pdf"},source:{type:"string",desc:"the paper's source i.e. where it was added to the memory from",validation:e=>{if(Object.keys(global.knownPaperPages).indexOf(e)<0)return"Unknown source "+e}},tags:{type:"array[string]",desc:"the user's tags for this paper",default:e=>[]},title:{type:"string",desc:"the paper's title",validation:e=>{if(!e)throw Error(`No title: ${e} for paper ${t.id}:
${JSON.stringify(t,null,2)}
Fix the json file and try again.
`)}},venue:{type:"string",desc:"the paper's publication venue",default:e=>""},year:{type:"string",desc:"year of publication",validation:e=>{if(!/^\d{4}$/.test(e))return`Invalid year (${e}): must be 4 digits exactly`}}},n={};for(a in i)if(n[a]||(n[a]=[]),t.hasOwnProperty(a)){var s,l=i[a].type,p=typeof t[a];l.includes("array")||"object"===l?l.includes("array")?Array.isArray(t[a])?(c=l.split("[")[1].replace("]",""),0<t[a].length&&(s=typeof t[a][0])!==c&&(message=`➤ ${a} should contain ${c} not ${s} (${t.id})`,n[a].push(message),e)&&console.warn(message)):(message=`${a} should be an array (${t.id})`,n[a].push(message),e&&console.warn(message)):Object(t[a])!==t[a]&&(message=`${a} should be an object (${t.id})`,n[a].push(message),e)&&console.warn(message):p!==l&&(message=`➤ ${a} should be of type ${l} not ${p} (${t.id})`,n[a].push(message),e)&&console.warn(message)}else if(i[a].default){var c=i[a].default(t);t[a]=c,message=`➤ Attribute "${a}" absent; will be set to '${JSON.stringify(c)}' (${t.id})`,n[a].push(message),e&&console.warn(message)}else if(!i[a].optional)throw new Error(`Cannot continue, paper is corrupted. Missing mandatory attribute "${a}" in `+t.id);for(r in i)i[r].validation&&(o=i[r].validation(t[r]))&&(n[r]||(n[r]=[]),n[r].push(o),e)&&console.warn(o+` (${t.id})`);return{warnings:n,paper:t}},prepareOverwriteData=async e=>{let t=!0,a="",r="",o;try{e.__dataVersion||(e.__dataVersion=1);var i,n,s=await migrateData(e,getManifestDataVersion(),!1);if(!s.success)return r="Could not migrate the data before storing it",s.error&&(r+=":<br/>"+stringifyError(s.error)),{success:!1,message:r};for(i in o=s.papers)i.startsWith("__")||(paperWarnings=validatePaper(o[i]).warnings)&&0<paperWarnings.length&&(a+="<br/>"+Object.entries(paperWarnings).map((e,t)=>`<h5>${e}</h5>`+t.join("<br/>")).join("<br/>"));a&&(n=await getStorage("papers")??{},setStorage("uploadBackup",n)),t=!1}catch(e){log("prepareOverwriteData error",e),r='<h5 class="errorTitle"> /!\\ OverwriteMemoryError:</h5><br/>'+stringifyError(e),t=!0}return{success:!t,message:r,warning:a,papersToWrite:o}},makeVenue=async e=>{let t="";switch((t=e.note&&e.note.match(/(accepted|published)\ @\ .+\(?\d{4}\)?/i)?e.note.split("@")[1].trim().replace(/\(?\d{4}\)?/,"").split("--")[0].trim():t)&&"neurips"===t.toLowerCase()&&(t="NeurIPS"),e.source){case"arxiv":break;case"neurips":t="NeurIPS";break;case"cvf":t=t||(await makeCVFPaper(e.pdfLink)).venue;break;case"openreview":t=t||(await makeOpenReviewPaper(e.pdfLink)).venue;break;case"biorxiv":break;case"pmlr":t=e.conf?.split(/\d{4}/)[0]??"";break;case"acl":t=e.conf??"";break;case"pnas":t="PNAS";break;case"nature":t=t||e.venue;break;case"iop":case"acs":t=e.venue}return t},makeTitleHashToIdList=e=>{var t,a,r={};for([t,a]of Object.entries(cleanPapers(e))){var o=miniHash(a.title);r.hasOwnProperty(o)||(r[o]=[]),r[o].push(t)}return r},isPaper=("undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={migrateData:migrateData,logStorage:logStorage,getStorage:getStorage,setStorage:setStorage,deletePaperInStorage:deletePaperInStorage,getTheme:getTheme,backupData:backupData,weeklyBackup:weeklyBackup,getPrefs:getPrefs,getManifestDataVersion:getManifestDataVersion,versionToSemantic:versionToSemantic,validatePaper:validatePaper,prepareOverwriteData:prepareOverwriteData,makeVenue:makeVenue,makeTitleHashToIdList:makeTitleHashToIdList}),async(e,t=!1)=>{var a={};if(e){for(var r in global.knownPaperPages){var o,i=global.knownPaperPages[r].patterns;a[r]=!1;for(o of i)if("string"==typeof o?e.includes(o)&&(a[r]=!0):"function"==typeof o&&(a[r]=o(e)),a[r])break}a.localFile=isKnownLocalFile(e),a.stored=!t&&(await findLocalFile(e)??!1),a.parsedWebsite=global.state.papers["Website_"+urlToWebsiteId(e)]??!1}return a}),isSourceURL=async(e,t)=>Object.values(await isPaper(e,t)).some(e=>e),paperToAbs=e=>{let t,a,r;var o=e.pdfLink;let i,n="";switch(e.source){case"arxiv":n=o.replace("/pdf/","/abs/").replace(".pdf","");break;case"neurips":n=o.replace("/file/","/hash/").replace("-Paper.pdf","-Abstract.html");break;case"cvf":n=o.replace("/papers/","/html/").replace(".pdf",".html");break;case"openreview":n=o.replace("/pdf?","/forum?");break;case"biorxiv":n=o.replace(".full.pdf","");break;case"pmlr":n=o.split("/").slice(0,-1).join("/")+".html";break;case"acl":n=o.replace(".pdf","");break;case"pnas":n=o.replace(".full.pdf","").replace("/doi/pdf/","/doi/full/");break;case"nature":n=o.replace(".pdf","");break;case"acs":n=o.replace("pubs.acs.org/doi/pdf/","pubs.acs.org/doi/").split("?")[0];break;case"iop":n=o.split("#")[0].replace(/\/pdf$/,"");break;case"jmlr":n=o.split("/").slice(0,-1).join("/").replace("/papers/volume","/papers/v")+".html";break;case"pmc":var s=o.match(/PMC\d+/)[0];n=o.split(s)[0]+s;break;case"ijcai":var s=o.replace(".pdf","").split("/").last().match(/[1-9]\d*/),l=o.match(/proceedings\/\d+/gi)[0].split("/")[1];n=`https://www.ijcai.org/proceedings/${l}/`+s;break;case"acm":n=o.replace("/doi/pdf/","/doi/");break;case"ieee":n="https://ieeexplore.ieee.org/document/"+e.key;break;case"springer":n=e.extra.url;break;case"aps":[t,a]=parseUrl(o).pathname.split("/").slice(1,3),n=o.replace(`/${t}/${a}/`,`/${t}/abstract/`);break;case"wiley":n=o.replace(/\/doi\/e?pdf\//g,"/doi/abs/");break;case"sciencedirect":i=o.split("/pii/")[1].split("/")[0].split("#")[0].split("?")[0],n="https://www.sciencedirect.com/science/article/pii/"+i;break;case"science":(r=o.split("/doi/")[1]).startsWith("10.")||(r=r.split("/").slice(1).join("/")),n="https://science.org/doi/full/"+r;break;case"frontiers":n=o.replace(/\/pdf$/,"/full");break;case"ihep":n="https://inspirehep.net/literature/"+e.id.split("-")[1];break;case"plos":n=o.replace("/article/file?","/article?").split("&")[0];break;case"rsc":n=o.replace("/articlepdf/","/articlelanding/");break;case"website":n=e.pdfLink;break;case"mdpi":n=e.pdfLink.split("/pdf")[0];break;case"oup":n="https://doi.org/"+e.doi;break;case"hal":n=o.split("/file/")[0].split("/document")[0];break;case"chemrxiv":n="https://chemrxiv.org/engage/chemrxiv/article-details/"+o.split("/item/")[1].split("/")[0];break;case"cell":const t=e.id.split("_")[0].split("fulltext")[0];i=new URL(o).searchParams.get("pii"),n=`https://www.cell.com/${t}/fulltext/`+i;break;case"aip":n="https://doi.org/"+e.doi;break;default:n="https://xkcd.com/1969/"}return n.replace("http://","https://")},paperToPDF=e=>{let t=e.pdfLink;switch(e.source){case"arxiv":t=t.replace("arxiv.org/abs/","arxiv.org/pdf/").replace(/\.pdf$/,"").replace(/v\d+$/gi,""),t+=".pdf";break;case"neurips":t=t.replace("/hash/","/file/").replace("-Abstract.html","-Paper.pdf");break;case"cvf":t=t.replace("/html/","/papers/").replace(".html",".pdf");break;case"openreview":t=t.replace("/forum?","/pdf?");break;case"biorxiv":t=cleanBiorxivURL(t)+".full.pdf";break;case"pmlr":case"acl":case"pnas":break;case"nature":t.endsWith(".pdf")||(t+=".pdf");break;case"iop":t.endsWith("/pdf")||(t+="/pdf");break;case"acs":case"jmlr":case"pmc":case"ijcai":case"acm":case"ieee":case"springer":case"aps":case"wiley":case"sciencedirect":case"science":case"frontiers":case"ihep":case"plos":case"rsc":case"mdpi":case"oup":case"hal":case"chemrxiv":case"website":case"cell":case"aip":break;default:t="https://xkcd.com/1969/"}return t.replace("http://","https://")},findLocalFile=async t=>{if("string"==typeof t){let e;try{e=await parseIdFromUrl(t)}catch(e){return new Promise(e=>e(null))}if(!global.state.papers.hasOwnProperty(e))return new Promise(e=>e(null));paper=global.state.papers[e]}else paper=t;t=await getStoredFiles(),t=await matchPapersToFiles({[paper.id]:paper},t),t=Object.values(t);return 1===t.length?t[0]:null},matchPapersToFiles=async(e,t)=>{var a,r=Object.fromEntries(Object.values(e).map(e=>[e.id,miniHash(e.title)])),o=(t=t.filter(e=>e.exists&&"complete"===e.state&&!e.filename.toLowerCase().includes("readme.txt")),Object.fromEntries(t.map(e=>[e.id,miniHash(e.filename)]))),i={};for(a of t){let t;try{(t=await parseIdFromUrl(a.finalUrl))&&e.hasOwnProperty(t)&&(i[t]=a)}catch(e){t=null}if(!t){let t=o[a.id];var n=Object.entries(r).find(([,e])=>t.includes(e));n&&(i[n[0]]=a)}}return i},matchAllFilesToPapers=()=>new Promise((t,e)=>{chrome.downloads.search({filenameRegex:"PaperMemoryStore/.*"},async e=>{e=await matchPapersToFiles(cleanPapers(global.state.papers),e);t(e)})}),mergePapers=(e={newPaper:{},oldPaper:{}})=>{let{oldPaper:t,newPaper:a,...r}=e;var o,i,n={...t},e={overwrites:["lastOpenDate"],incrementCount:!1,syncMerge:!1,...r};for(o in a)(!t.hasOwnProperty(o)||a[o]&&!t[o])&&(n[o]=a[o]);e.incrementCount&&1===n.count&&(n.count+=1),e.syncMerge&&(n.count=t.count+a.count,n.note=t.note??"",a.note&&a.note!==t.note&&(n.note+="\n\n--[Sync Merge]--\n",n.note+=a.note),n.tags=[...t.tags,...a.tags],n.lastOpenDate=a.lastOpenDate,a.lastOpenDate>t.lastOpenDate&&(n.lastOpenDate=a.lastOpenDate),n.addDate=a.addDate,a.addDate>t.addDate)&&(n.addDate=a.addDate);for(i of e.overwrites)a.hasOwnProperty(i)&&(n[i]=a[i]);return n},updatePaperVisits=e=>(e.count+=1,e.lastOpenDate=(new Date).toJSON(),log("Updating paper to:",e),e),addOrUpdatePaper=async({url:a,is:r,prefs:o,tab:e,store:i=!0,contentScriptCallbacks:n={update:()=>{},preprints:()=>{}}})=>{let s=Date.now(),l,p,c={};consoleHeader("PaperMemory Parsing "+String.fromCodePoint("0x1F4DD")),global.state.papers=await getStorage("papers")??{};var t=await parseIdFromUrl(a,e),d=global.state.papers.hasOwnProperty(t);if(o&&o.checkFeedback&&feedback({loading:!0}),t&&d&&"anonymous"!==global.state.papers[t].author.toLowerCase())l=updatePaperVisits(global.state.papers[t]),p=!1;else{let t=await makePaper(r,a,e);if(!t)return;global.state.titleHashToIds=makeTitleHashToIdList(global.state.papers);d=findFuzzyPaperMatch(global.state.titleHashToIds,t);if(d&&i){let e=global.state.papers[d];log("New paper",t,"already exists as",e),addPaperToTitleHashToId(t),e.venue?(r=["lastOpenDate"],"anonymous"===e.author.toLowerCase()&&(r.push("author"),r.push("year"),r.push("venue"),r.push("bibtex"),r.push("note")),console.log("overwrites: ",r),e=mergePapers({newPaper:t,overwrites:r,oldPaper:e,incrementCount:!1}),updateDuplicatedUrls(a,d)):t.venue?(updateDuplicatedUrls(paperToAbs(e),t.id),updateDuplicatedUrls(paperToPDF(e),t.id),await deletePaperInStorage(e.id,global.state.papers),e=mergePapers({newPaper:t,oldPaper:e,incrementCount:!1,overwrites:["lastOpenDate","venue","bibtex","id","key","pdfLink","source","year","author"]})):"anonymous"===e.author.toLowerCase()&&(e=mergePapers({newPaper:t,oldPaper:e,incrementCount:!0,overwrites:["lastOpenDate","author","year","venue","bibtex","note"]})),t=updatePaperVisits(e),p=!1}else p=!0;l=t}if(!l.codeLink||!l.venue)try{var u=await silentPromiseTimeout(tryPWCMatch(l)),h=!l.codeLink&&u?.codeLink,m=u?.note,f=u?.bibtex,g=!l.venue&&u?.venue;(c={codeLink:h,note:m,venue:g,bibtex:f}).codeLink&&(l.codeLink=c.codeLink,u.hasOwnProperty("note")&&delete u.note,l.code=u)}catch(e){log("Error trying to discover a code repository:"),log(e)}return global.state.papers=await getStorage("papers")??{},p&&global.state.papers.hasOwnProperty(l.id)&&(warn("Paper has been created by another page: merging papers."),l=mergePapers({newPaper:global.state.papers[l.id],oldPaper:l,incrementCount:!0}),p=!1),i&&!global.state.deleted[l.id]&&(global.state.papers[l.id]=l),chrome.storage.local.set({papers:global.state.papers},async()=>{n.update(l),pushToRemote();let e;if(p||c.codeLink?p?(i?logOk("Added '"+l.title+"' to your Memory!"):warn("Discovered '"+l.title+"' but did not store it (`store` is false)."),log("paper: ",l),e="Saved ✓",c.codeLink&&(e+="<br/><div id='feedback-pwc'>(+ repo from PapersWithCode) </div>"),o&&o.checkFeedback&&i&&feedback({text:e,paper:l})):(e="Found a code repository on PapersWithCode!",o&&o.checkFeedback&&i&&feedback({text:e})):i&&logOk("Updated '"+l.title+"' in your Memory"),!l.note||!l.venue||"anonymous"===l.author.toLowerCase()){var t,a,r=await tryPreprintMatch(l);for(t of["note","venue","bibtex","doi"])l[t]&&"bibtex"!==t||(a=r[t]??c[t])&&(log(`Updating preprint ${t} to`,a),l[t]=a),"bibtex"===t&&r[t]&&(a=bibtexToObject(r[t])).year!==l.year&&(l.year=a.year);global.state.papers=await getStorage("papers")??{},p&&global.state.papers.hasOwnProperty(l.id)&&1<global.state.papers[l.id].count&&(warn("Paper has been created by another page: merging papers."),l=mergePapers({newPaper:global.state.papers[l.id],oldPaper:l,incrementCount:!1})),i&&!global.state.deleted[l.id]&&(global.state.papers[l.id]=l),await new Promise(e=>chrome.storage.local.set({papers:global.state.papers},e))}n.preprints(l),pushToRemote(),info(`Done processing paper (${(Date.now()-s)/1e3}s).`),console.groupEnd()}),{paper:l,id:t}},findPaperForProperty=(e,t,a,r="id")=>e.find(e=>e.source===t&&e[r].includes(a))?.id,parseIdFromUrl=async(a,e=null)=>{if(e)return urlToWebsiteId(a);let r;e=miniHash(a),e=global.state.urlHashToId[e];if(e)return e;var e=await isPaper(a,!0),o=Object.values(cleanPapers(global.state.papers));if(e.arxiv){var t=arxivIdFromURL(a),t=(r="Arxiv-"+t,Object.values(global.state.titleHashToIds).find(e=>e.includes(r)));t&&(r=t.find(e=>!e.startsWith("Arxiv-"))??r)}else if(e.neurips){var t=a.split("/paper/")[1].split("/")[0],i=a.split("/").last().split("-")[0].slice(0,8);r=`NeurIPS-${t}_`+i}else if(e.cvf)r=parseCVFUrl(a).id;else if(e.openreview){t=a.match(/id=\w+/)[0].replace("id=","");r=findPaperForProperty(o,"openreview",t)}else if(e.biorxiv){let e=(a=cleanBiorxivURL(a)).split("/").last();e.match(/v\d+$/)&&(e=e.split("v")[0]),r="Biorxiv-"+e;var i=Object.values(global.state.titleHashToIds).find(e=>e.includes(r));i&&(r=i.find(e=>!e.startsWith("Biorxiv-"))??r)}else if(e.pmlr){t=a.split("/").last().split(".")[0],i="20"+t.match(/\d+/)[0];r=`PMLR-${i}-`+t}else if(e.acl){i=(a=(a=a.replace(".pdf","")).endsWith("/")?a.slice(0,-1):a).split("/").last();r=findPaperForProperty(o,"acl",i)}else if(e.pnas){t=((a=a.replace(".full.pdf","")).endsWith("/")?a.split("/").slice(-2):a.split("/").slice(-1))[0];r=findPaperForProperty(o,"pnas",t)}else if(e.nature){i=(a=a.replace(".pdf","").split("#")[0]).split("/").last();r=findPaperForProperty(o,"nature",i)}else if(e.acs){a=noParamUrl(a).replace("pubs.acs.org/doi/pdf/","/doi/").replace("pubs.acs.org/doi/abs/","/doi/");let e=miniHash(a.split("/doi/")[1]);r="ACS_"+e}else if(e.iop){a=noParamUrl(a).replace(/\/pdf$/,"");let e=miniHash(a.split("/article/")[1].split("/meta")[0]);r="IOPscience_"+e}else if(e.jmlr){t=(a=(a=a.endsWith(".pdf")?a.split("/").slice(0,-1).join("/"):a).replace(".html","")).split("/").last(),i="20"+t.match(/\d+/)[0];r=`JMLR-${i}_`+t}else if(e.pmc){i=a.match(/PMC\d+/g)[0].replace("PMC","");r=findPaperForProperty(o,"pmc",i)}else if(e.ijcai){t=a.endsWith(".pdf")?a.replace(".pdf","").split("/").last().match(/[1-9]\d*/):a.split("/").last(),i=a.match(/proceedings\/\d+/gi)[0].split("/")[1];r=`IJCAI-${i}_`+t}else if(e.acm){let e=a.replace(/\/doi\/?(pdf|abs|full)?\//,"/doi/").split("/doi/")[1];r=findPaperForProperty(o,"acm",miniHash(e))}else if(e.ieee){i=(a.includes("ieee.org/document/")?a.split("ieee.org/document/"):a.includes("ieee.org/abstract/document/")?a.split("ieee.org/abstract/document/"):a.split("arnumber="))[1].match(/\d+/)[0];r=findPaperForProperty(o,"ieee",i)}else if(e.springer){let e=global.sourceExtras.springer.types.filter(e=>a.includes(`/${e}/`))[0];if(!e){if(!a.includes("/content/pdf/"))throw new Error("Could not find Springer type for "+a);e="content/pdf"}t=noParamUrl(a).split(`/${e}/`)[1].replace(".pdf","");r=findPaperForProperty(o,"springer",miniHash(t))}else if(e.aps){var[i,t]=parseUrl(a.split("#")[0]).pathname.split("/").slice(1,3);let e=a.split(`/${i}/${t}/`).last();r=findPaperForProperty(o,"aps",miniHash(e))}else if(e.wiley){let e=a.split("?")[0].split("#")[0].split("/").slice(-2).join("/");r=findPaperForProperty(o,"wiley",miniHash(e))}else if(e.sciencedirect){i=a.split("/pii/")[1].split("/")[0].split("#")[0].split("?")[0];r=findPaperForProperty(o,"sciencedirect",miniHash(i))}else if(e.science)(doi=noParamUrl(a).split("/doi/")[1]).startsWith("10.")||(doi=doi.split("/").slice(1).join("/")),r=findPaperForProperty(o,"science",miniHash(doi));else if(e.frontiers)doi=noParamUrl(a).split("/articles/")[1].split("/").slice(0,-1).join("/"),r=findPaperForProperty(o,"frontiers",miniHash(doi));else if(e.ihep)r=a.includes("/literature/")?(t=noParamUrl(a).match(/\/literature\/(\d+)/)[1],findPaperForProperty(o,"ihep",t)):(i=noParamUrl(a).split("/files/")[1].split("/")[0],findPaperForProperty(o,"ihep",i,"pdfLink"));else if(e.plos){let e=a.split("?id=").last().split("&")[0];r=findPaperForProperty(o,"plos",miniHash(e))}else if(e.rsc){t=noParamUrl(a).replace("/unauth","").split("/").last();r=findPaperForProperty(o,"rsc",miniHash(t))}else if(e.mdpi){i=noParamUrl(a.split("mdpi.com/")[1].split("/pdf")[0].split("/reprints")[0].split("/notes")[0]);r=findPaperForProperty(o,"mdpi",miniHash(i))}else if(e.oup){a=noParamUrl(a).split("https://academic.oup.com/").last();t=(a=isPdfUrl(a)?a.split("/").slice(0,-1).join("/"):a).split("/").slice(2).join("");r=findPaperForProperty(o,"oup",miniHash(t))}else if(e.hal){i=(a=noParamUrl(a).replace(/(hal\.science\/\w+-\d+)(v\d+)?((\/document|\/file\/.+\.pdf))?/,"$1")).split("/").last();r=findPaperForProperty(o,"hal",miniHash(i))}else if(e.chemrxiv)chemRxivId=chemRxivId=isPdfUrl(a)?a.split("/item/")[1].split("/")[0]:noParamUrl(a).split("/").last(),r=findPaperForProperty(o,"chemrxiv",miniHash(chemRxivId));else if(e.cell)a=(await findCellPii(a)).url,r=findPaperForProperty(o,"cell",miniHash(a.split("cell.com/")[1]));else if(e.aip){let{aipId:e,doi:t}=parseAIPIdOrDOI(a);r=t?findPaperForProperty(o,"aip",t,"doi"):findPaperForProperty(o,"aip",miniHash(e))}else if(e.localFile)r=e.localFile;else{if(!e.parsedWebsite)throw new Error("`parseIdFromUrl` failed, unknown paper url. Is: "+JSON.stringify(e));r=e.parsedWebsite.id}return r},isKnownLocalFile=e=>{if(!e.startsWith("file://"))return!1;if(!e.endsWith(".pdf"))return!1;let t=decodeURIComponent(e).replace("file://","");var a=Object.entries(global.state.files).filter(([,e])=>e.filename===t);if(0<a.length)return console.log("Found stored"),a[0][0];let r=decodeURIComponent(e.split("/").last()).toLowerCase().replace(/\W/g,"");a=Object.values(cleanPapers(global.state.papers)).map(e=>({title:miniHash(e.title),id:e.id})).filter(e=>r.includes(e.title));return 0!==a.length&&a[0].id},makeMdLink=(e,t={})=>{var a=(t.checkPreferPdf?paperToPDF:paperToAbs)(e);let r="",o=(!t.checkMdYearVenue||(r=(r=e.note.match(/(.+)\s*@\s*([\w\s]+\(?\d{4}\)?)/i))&&r[2]?.replace(/\s+/g," ").replace(/[\(\)]/g,""))||(r="",e.venue&&(r+=e.venue+" "),r+=e.year),e.title);return`[${o=r?`${o} (${r.replace(/\s+/g," ")})`:o}](${a})`},duration=("undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={isPaper:isPaper,isSourceURL:isSourceURL,paperToAbs:paperToAbs,paperToPDF:paperToPDF,findLocalFile:findLocalFile,matchPapersToFiles:matchPapersToFiles,matchAllFilesToPapers:matchAllFilesToPapers,mergePapers:mergePapers,updatePaperVisits:updatePaperVisits,addOrUpdatePaper:addOrUpdatePaper,findPaperForProperty:findPaperForProperty,parseIdFromUrl:parseIdFromUrl,isKnownLocalFile:isKnownLocalFile,makeMdLink:makeMdLink}),e=>(Date.now()-e[0])/1e3),initState=async({papers:e,isContentScript:t,print:a=!0}={})=>{var r=[],o=(r.unshift(Date.now()),a&&consoleHeader("PaperMemory Init "+String.fromCodePoint("0x2705")),e||(e=await getStorage("papers")??{},a&&log("Time to retrieve stored papers (s): "+duration(r))),r.unshift(Date.now()),global.state.dataVersion=getManifestDataVersion(),a&&log("Time to parse data version (s): "+duration(r)),r.unshift(Date.now()),weeklyBackup(),a&&log("Time to backup papers (weekly) (s): "+duration(r)),r.unshift(Date.now()),await migrateData(e,global.state.dataVersion));a&&log("Time to migrate data (s): "+duration(r)),r.unshift(Date.now()),e=o.papers,global.state.papers=e,global.state.prefs=await getPrefs(),a&&log("Time to retrieve user preferences (s): "+duration(r)),r.unshift(Date.now()),global.state.ignoreSources=await getStorage("ignoreSources")??{},a&&log("Time to retrieve sources to ignore (s): "+duration(r)),r.unshift(Date.now()),global.state.urlHashToId=await getStorage("urlHashToId")??{},a&&log("Time to retrieve sources to urlHashToId (s): "+duration(r)),r.unshift(Date.now()),global.state.titleHashToIds=makeTitleHashToIdList(e),a&&log("Time to hash titles (s): "+duration(r)),r.unshift(Date.now()),t||(global.state.files=await matchAllFilesToPapers(),a&&log("Time to match all local files (s): "+duration(r)),r.unshift(Date.now()),global.state.papersList=Object.values(cleanPapers(e)),global.state.sortKey="lastOpenDate",global.state.papersReady=!0,sortMemory(),a&&log("Time to sort memory (s): "+duration(r)),r.unshift(Date.now()),makeTags(),a&&log("Time to make tags (s): "+duration(r)),r.unshift(Date.now())),info("State init duration (s): "+(Date.now()-r.last())/1e3),a&&console.groupEnd(),(async()=>{var e=chrome.runtime.getURL("src/data/cell.json"),e=await fetch(e).then(e=>e.json());global.state.cellJournalData=e})()},sortMemory=()=>{global.state.sortedPapers=Object.values(cleanPapers(global.state.papers)),global.state.sortedPapers.sort(orderPapers(0<=global.descendingSortKeys.indexOf(global.state.sortKey))),global.state.papersList.sort(orderPapers(0<=global.descendingSortKeys.indexOf(global.state.sortKey)))},orderPapers=o=>(e,t)=>{let a=e[global.state.sortKey],r=t[global.state.sortKey];return void 0===a&&(a=""),void 0===r&&(r=""),"string"==typeof a&&(a=a.toLowerCase(),r=r.toLowerCase()),o?a>r?-1:1:a>r?1:-1},makeTags=()=>{var e,t=new Set;for(e of global.state.sortedPapers)for(var a of e.tags)t.add(a);global.state.paperTags=[...t],global.state.paperTags.sort()},getExamplePaper=async e=>{var t=await getStorage("papers")??{},a=Object.keys(t).filter(e=>-1===e.indexOf("__")).reverse();let r=t[a[e=void 0===e?getRandomInt(a.length):e]];return r=void 0===r?{title:"Dummy title",author:"Cool Author and Great Author and Complicated Name Àuthor",year:2021,id:"NoneXiv-214324",bibtex:"@Nonesense{}",tags:["t1","t2"],note:"Thispaperdoesnotexist.com"}:r},stateTitleFunction=e=>{let t=e;return"string"==typeof e&&void 0===(t=global.state.papers[e])?(log("Error in stateTitleFunction: unknown id",e),"Unknown ID"):global.state.titleFunction(t).replaceAll("\n"," ").replace(/\s\s+/g," ")},updateDuplicatedUrls=(t,a,e=!1)=>{if(e){let e;if((e=t?[miniHash(t)]:Object.keys(global.state.urlHashToId).filter(e=>global.state.urlHashToId[e]===a))&&e.length){for(var r of e)warn("Removing duplicated url",t,"for",a),delete global.state.urlHashToId[r];setStorage("urlHashToId",global.state.urlHashToId)}}else global.state.urlHashToId[miniHash(t)]=a,setStorage("urlHashToId",global.state.urlHashToId)},addPaperToTitleHashToId=e=>{var t=e.id,e=miniHash(e.title);global.state.titleHashToIds.hasOwnProperty(e)||(global.state.titleHashToIds[e]=[]),global.state.titleHashToIds[e].includes(t)||global.state.titleHashToIds[e].push(t)},readJournalAbbreviations=async()=>{var e,t;global.journalAbbreviations||(e=chrome.runtime.getURL("src/data/iso4-journals.json"),e=await fetch(e).then(e=>e.json()),t=chrome.runtime.getURL("src/data/journal-abbreviations.json"),t=await fetch(t).then(e=>e.json()),global.journalAbbreviations=Object.fromEntries([...Object.entries(e),...Object.entries(t)].map(([e,t])=>[miniHash(e),t])))},downloadPaperPdf=async e=>{if(!global.state.papersReady)throw new Error("[PM] State is not ready (downloadPaperPdf)");let t=stateTitleFunction(e);t=(t=t.replaceAll(":"," ")).replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,\/:;<=>?@\[\]^`{|}~]/g," ").replace(/\s+/g," "),global.state.prefs.checkStore&&(t="PaperMemoryStore/"+t,0===(await getStoredFiles()).length)&&chrome.downloads.download({url:URL.createObjectURL(new Blob([global.storeReadme])),filename:"PaperMemoryStore/IMPORTANT_README.txt",saveAs:!1}),(t=t.endsWith("pdf")?t.slice(0,-3)+".pdf":t).endsWith(".pdf")||(t+=".pdf"),log("Downloading paper",e,"to",t),chrome.downloads.download({url:paperToPDF(e),filename:t})},decodeHtml=("undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={duration:duration,initState:initState,sortMemory:sortMemory,orderPapers:orderPapers,makeTags:makeTags,getExamplePaper:getExamplePaper,stateTitleFunction:stateTitleFunction,updateDuplicatedUrls:updateDuplicatedUrls,addPaperToTitleHashToId:addPaperToTitleHashToId,readJournalAbbreviations:readJournalAbbreviations,downloadPaperPdf:downloadPaperPdf}),e=>{var t=document.createElement("textarea");return t.innerHTML=e,t.value}),flipAuthor=e=>e.split(", ").reverse().join(" "),flipAndAuthors=e=>e.split(" and ").map(flipAuthor).join(" and "),fetchCvfHTML=async e=>{let t,a;var r;return t=e.endsWith(".pdf")?e.replace("/papers_backup/","/papers/").replace("/papers/","/html/").replace(".pdf",".html"):e,!(a=await fetch(t).then(e=>e.ok?e.text():""))&&t.includes("thecvf.com/content_")&&({conf:e,year:r}=parseCVFUrl(e),t=t.replace(`/content_${e}_${r}/`,`/content_${e.toLowerCase()}_${r}/`),a=await fetch(t).then(e=>e.ok?e.text():"")),a},getOpenReviewNoteJSON=e=>sendMessageToBackground({type:"OpenReviewNoteJSON",url:e}),getOpenReviewForumJSON=e=>sendMessageToBackground({type:"OpenReviewForumJSON",url:e}),fetchDom=async e=>{e=await fetch(e).then(e=>e.ok?e.text():"");return(new DOMParser).parseFromString(e.replaceAll("\n",""),"text/html")},fetchText=async e=>{try{var t=await fetch(e);return(t.ok?await t.text():"").trim()}catch(e){return logError("fetchText error:",e),""}},fetchJSON=async e=>{try{var t=await fetch(e),a=t.status;return{data:t.ok?await t.json():null,status:a}}catch(e){return logError("fetchJSON error:",e),{}}},fetchBibtexToPaper=async({url:e,doi:t})=>{let a;if(e&&t)throw new Error("fetchBibtexToPaper: both url and doi provided");if(t)a=await fetchText(`https://citation.doi.org/format?doi=${t}&style=bibtex&lang=en-US`);else{if(!e)throw new Error("fetchBibtexToPaper: no url or doi provided");a=await fetchText(e)}t=bibtexToObject(a);return delete t.abstract,a=bibtexToString(t),t.bibtex=a,t.key=t.citationKey,t.journal&&(t.venue=t.journal,t.note=`Published in ${t.journal} (${t.year})`),t},extractCrossrefData=e=>{if(e.status&&"ok"===e.status)if("work"!==e["message-type"])error("Unknown `message-type` from CrossRef",e);else{var t=e.message,a=(log("Crossref data.message: ",t),t.author.map(e=>e.given+" "+e.family).join(" and ")),r=t.issued?t.issued["date-parts"][0][0]+"":t.published?t.published["date-parts"][0][0]+"":null;if(r){var o,i,n,s=t.title[0];if(s)return o=t["container-title"][0]??"Springer",n=[miniHash(t.author[0].family),r.slice(2),firstNonStopLowercase(s)].join(""),i=t.DOI,n={entryType:"book"===t.type?"book":"book-chapter"===t.type?"InBook":t.type.includes("article")?"Article":"InProceedings",citationKey:n,publisher:t.publisher,author:a,title:s,year:r,doi:i},t.page&&(n.pages=t.page),t.volume&&(n.volume=t.volume),t.type.includes("journal")&&(n.journal=o),t.link&&0<t.link.length&&((a=t.link.find(e=>"application/pdf"===e["content-type"]))&&(n.pdf=a.URL),s=t.link.find(e=>"text/html"===e["content-type"])??t.link[0])&&(n.url=s.URL),r=bibtexToString(n),{...n,bibtex:r,venue:o};error("Cannot find title in CrossRef data",t)}else error("Cannot find year in CrossRef data",t)}else error("Cannot parse CrossRef response",e)},fetchCrossRefDataForDoi=async e=>{var{data:e,status:t}=await fetchJSON(`https://api.crossref.org/works/${e}?mailto=schmidtv%40mila.quebec`);return{data:extractCrossrefData(e),status:t}},fetchSemanticScholarDataForDoi=async e=>{var t,e=(await fetchJSON(`https://api.semanticscholar.org/graph/v1/paper/${e}?fields=venue,year,authors,title`)).data;let a;return e&&(a={},e.venue&&(a.venue=e.venue),e.year&&(a.year=e.year),e.authors&&(a.author=e.authors.map(e=>e.name).join(" and ")),e.title&&(a.title=e.title),e=""+miniHash(e.authors[0].name)+firstNonStopLowercase(a.title),t=bibtexToString({entryType:"article",citationKey:e,...a}),a.bibtex=t,a.key=e),a},getDCPatterns=e=>{let t=e.slice(3);var e=["dc.","DC:","DC.","dc:"].map(e=>e+t.toLowerCase()),a=["dc.","DC:","DC.","dc:"].map(e=>e+t.capitalize());return[...e,...a]},getMetaContent=({selector:a,dom:t,all:e=!1,pure:r=!1})=>{let o="";for(let[t,e]of Object.entries(a))/dc\W/.test(e.toLowerCase())?o+=getDCPatterns(e).map(e=>`meta[${t}='${e}']`).join(","):o+=`meta[${t}='${e}']`;if(e){let e=queryAll(o,t).map(e=>e.getAttribute("content")??"");return r?e:e.map(spaceCamelCase).map(toSingleSpace)}let i=t.querySelector(o)?.getAttribute("content")??"";return r?i:toSingleSpace(spaceCamelCase(i))},extractDataFromDCMetaTags=e=>{var t,a,r,o,i,n,s=getMetaContent({selector:{name:"dc.Creator"},dom:e,all:!0}).join(" and ")||getMetaContent({selector:{name:"citation_author"},dom:e,all:!0}).join(" and ");return s?(t=(getMetaContent({selector:{name:"dc.Date"},dom:e})||getMetaContent({selector:{name:"citation_publication_date"},dom:e})).split("-")[0].split("/")[0],a=getMetaContent({selector:{name:"dc.Publisher"},dom:e}).replaceAll("\n"," ")||getMetaContent({selector:{property:"og:site_name"},dom:e,pure:!0}),r=getMetaContent({selector:{name:"dc.Title"},dom:e})||getMetaContent({selector:{name:"citation_title"},dom:e}),o=getMetaContent({selector:{name:"citation_journal_title"},dom:e}),i=getMetaContent({selector:{name:"citation_pdf_url"},dom:e,pure:!0}),e=getMetaContent({selector:{scheme:"doi"},dom:e})||getMetaContent({selector:{name:"citation_doi"},dom:e}),n=(""+s.split(" and ")[0].split(" ").find((e,t)=>1<=t&&1<miniHash(e).length)+t+firstNonStopLowercase(r)).toLowerCase(),{author:s,year:t,publisher:a,title:r,venue:o,key:n,doi:e,bibtex:bibtexToString({citationKey:n,entryType:"article",title:r,author:s,year:t,doi:e,publisher:a,journal:o}),pdfLink:i,note:o?`Published @ ${o} (${t})`:""}):null},makeArxivPaper=async e=>{var e=arxivIdFromURL(e),t=await sendMessageToBackground({type:"fetch-arxiv-xml",arxivId:e}),t=(new DOMParser).parseFromString(t.replaceAll("\n",""),"text/xml"),a=queryAll("author name",t).map(e=>e.innerHTML),r=a.join(" and "),o=[...t.getElementsByTagName("link")].map(e=>e.getAttribute("href")).filter(e=>e.includes("arxiv.org/pdf/"))[0].replace(/v\d+(\.pdf)?$/gi,".pdf"),i=(i=t.querySelector("entry title"))?.textContent||i?.innerText||"",t=t.querySelector("entry published").innerHTML.slice(0,4),a=a[0].split(" ").last().toLowerCase()+t+firstNonStopLowercase(i),n="Arxiv-"+e.replace("/","_"),s="";return{author:r,bibtex:s+`@article{${a},
`+`    title={${i} },
`+`    author={${r} },
`+`    year={${t}},
`+`    journal={arXiv preprint arXiv: ${e}}
`+"}",id:n,key:a,pdfLink:o,title:i,venue:"",year:t}},makeNeuripsPaper=async e=>{var t=(e=e.endsWith(".pdf")?e.replace("/file/","/hash/").replace(/-Paper(.*)\.pdf/,"-Abstract$1.html"):e).split("/").slice(-1)[0].split("-Paper")[0],a=await fetchDom(e),r=[...a.getElementsByTagName("a")].filter(e=>"Bibtex"===e.innerText)[0]?.getAttribute("href");let o,i,n,s,l;r?(o=await fetchText("https://"+parseUrl(e).host+r),{author:i,citationKey,title:n,year:s}=bibtexToObject(o),i=flipAndAuthors(i),l=citationKey):(r=queryAll(".container-fluid .col p",a),n=a.getElementsByTagName("h4")[0].innerHTML,a=queryAll("h4",a).filter(e=>"Authors"===e.innerText)[0],i=a.nextElementSibling.innerText.split(", ").map(e=>e.split(" ").map(e=>e.capitalize()).join(" ")).join(" and "),s=r[0].innerHTML.match(/\d{4}/)[0],l="neurips"+s+t.slice(0,8),o="",o=(o=(o=(o=(o+=`@inproceedings{NEURIPS${s}_${t.slice(0,8)},
`)+`    author={${i}},
`+`    booktitle={Advances in Neural Information Processing Systems},
`)+`    editor={H.Larochelle and M.Ranzato and R.Hadsell and M.F.Balcan and H.Lin},
`+`    publisher={Curran Associates, Inc.},
`)+`    title={${n}},
`+`    url={${e}},
`)+`    year={${s}}
`+"}",o=bibtexToString(o));a=e.replace("/hash/","/file/").replace("-Abstract.html","-Paper.pdf"),r=`NeurIPS-${s}_`+t.slice(0,8),e="NeurIPS",t=`Accepted @ ${e} (${s})`;return{author:i,bibtex:o,id:r,key:l,note:t,pdfLink:a,title:n,venue:e,year:s}},makeCVFPaper=async e=>{var t=await fetchCvfHTML(e),t=(new DOMParser).parseFromString(t.replaceAll("\n",""),"text/html"),a=t.getElementById("papertitle").innerText.trim(),r=t.querySelector("#authors i").innerText.split(",").map(e=>e.trim()).join(" and "),{year:o,id:i,conf:n}=parseCVFUrl(e);let s="";if(e.endsWith(".pdf"))s=e;else{let e=[...t.getElementsByTagName("a")].filter(e=>"pdf"===e.innerText)[0].getAttribute("href");(e=e.startsWith("../")?e.replaceAll("../",""):e).startsWith("/")||(e="/"+e),s="http://openaccess.thecvf.com"+e}var e=n,n=`Accepted @ ${e} (${o})`,t=bibtexToString(t.querySelector(".bibref").innerText),l=t.split("{")[1].split(",")[0];return{author:r,bibtex:t,id:i,key:l,note:n,pdfLink:s,title:a,venue:e,year:o}},makeOpenReviewBibTex=(e,t)=>{var a=e.content.title,r=e.content.authors.join(" and "),o=e.cdate?new Date(e.cdate).getFullYear():"0000",e=(e.cdate||log("makeOpenReviewBibTex: no cdate found in",e),e.content.authors[0].split(" ").last()),i="";return i+`@inproceedings{${e=(e+=o)+firstNonStopLowercase(a)},
`+`    title={${a}},
`+`    author={${r}},
`+`    year={${o}},
`+`    url={${t}},
`+"}"},extractAPIv2ContentValue=e=>{var t,a,r={};let o=!1;for([t,a]of Object.entries(e.content))a&&a.value?(r[t]=a.value,o=!0):r[t]=a;return e.content=r,{isV2:o,paper:e}},makeOpenReviewPaper=async e=>{var t=await getOpenReviewNoteJSON(e),a=await getOpenReviewForumJSON(e);if(403===t.status&&"ForbiddenError"===t.name)throw logError(dedent(`Error parsing OpenReview url ${e}.
            Most likely because this entry is protected and you do not have the rights to access it.

            1/ Make sure you are logged in.
            2/ Alternatively, this may be due to OpenReview changing the visibility of this paper.

            Try accessing this URL manually to make sure.`)),Error(t.message);if(404===t.status&&"NotFoundError"===t.name)throw logError(dedent(`Error parsing OpenReview url ${e}.`)),Error(t.message);var t=t.notes[0],r=!1,a=a.notes,o=({isV2:r,paper:t}=extractAPIv2ContentValue(t),console.log("paper",t),t.content.title),i=(t.content.authors||t.content.authors?.value||["Anonymous"]).join(" and "),n=bibtexToString(t.content._bibtex||makeOpenReviewBibTex(t,e)),s=bibtexToObject(n),l=s.citationKey,p=s.year;let c;c=t.pdf?"https://openreview.net/pdf?id="+t.id:(t.html||e).replace("/forum?id=","/pdf?id=");e=t.invitation?.split("/")||t.domain.split("/");let d=e[0].split(".")[0],u=e.slice(1).join("/").split("-")[0].replaceAll("/"," ").replace(" Conference",""),h=d,m=!1;global.overrideORConfs.hasOwnProperty(d)&&(h=global.overrideORConfs[d],m=!0),m&&(u=u.replace(h,""),d=h);e=(d+" "+u).replace(/ \d\d\d\d/g,"").replace(/\s\s+/g," "),t=`OR-${d}-${p}_`+t.id;let f,g,y,b="";return(f=r?a.filter(e=>e?.content?.recommendation?.value):a.filter(e=>-1<["Final Decision","Paper Decision","Acceptance Decision"].indexOf(e?.content?.title)))&&0<f.length&&(g=(g=r?f[0].content.recommendation.value:f[0].content.decision).split(" ").map((e,t)=>0===t?cleanStr(e)+"ed":e).join(" "),y=g+` @ ${e} (${p})`,g.toLowerCase().indexOf("rejected")<0)&&(b=e),"Anonymous"!==i&&!b&&s.booktitle&&(y="Accepted @ "+s.booktitle,b=s.booktitle),{author:i,bibtex:n,id:t,key:l,note:y="Anonymous"===i&&"Rejected"!=g?`Under review @ ${e} (${p}) (${(new Date).toLocaleDateString()})`:y,pdfLink:c,title:o,venue:b,year:p}},makeBioRxivPaper=async e=>{var t=e.replace(".full.pdf",""),a="https://api.biorxiv.org//details/biorxiv/"+e.split("/").slice(-2).join("/").replace(".full.pdf","").split("v")[0],r=await fetch(a).then(e=>e.json());if("ok"!==r.messages[0].status)throw new Error(a+" returned "+r.messages[0].status);var a=r.collection.last(),r=await fetchText(t),t=(new DOMParser).parseFromString(r.replaceAll("\n",""),"text/html").querySelector(".bibtext a").getAttribute("href"),r=bibtexToString(await(await fetch(t)).text()),t=extractAuthor(r),o=await parseIdFromUrl(e),i=r.split("\n")[0].split("{")[1].replace(",","").trim();return{author:t,bibtex:r,id:o,key:i,note:"",pdfLink:cleanBiorxivURL(e)+".full.pdf",title:a.title,venue:"",year:a.date.split("-")[0]}},makePMLRPaper=async e=>{var t,a=e.split("/").last().split(".")[0],r=await parseIdFromUrl(e),e=e.includes(".html")?e:e.split("/").slice(0,-2).join("/")+`/${a}.html`,o=e.replace(".html","")+`/${a}.pdf`,e=await fetchDom(e),i=e.getElementById("bibtex").innerText.replaceAll("\t"," ").replaceAll(/\s\s+/g," ");let n=i;for(t of i.match(/,\ ?\w+ ?= ?{/g))n=n.replace(t,t.replace(", ",",\n    ").replace(" = ","="));n.endsWith("}}")&&(n=n.slice(0,-2)+"}\n}"),n=bibtexToString(n);var s,i=extractAuthor(n),e=e.getElementsByTagName("h1")[0].innerText,l=extractBibtexValue(n,"year");let p=extractBibtexValue(n,"booktitle").replaceAll("Proceedings of the",""),c=p;for(s in note=`Accepted @ ${c} (${l})`,global.overridePMLRConfs)if(p.includes(s)){c=global.overridePMLRConfs[s],p=c+" "+l,note="Accepted @ "+p;break}return{author:i,bibtex:n,id:r,key:a,note:note,pdfLink:o,title:e,venue:c,year:l}},findACLValue=(e,t)=>queryAll("dt",e).filter(e=>e.innerText.includes(t))[0].nextElementSibling.innerText,makeACLPaper=async e=>{e=e.replace(".pdf","");var t,a,r,o,i,n,e=await fetchDom(e),s=e.getElementById("citeBibtexContent");if(s)return t=e.getElementById("title").innerText,s=bibtexToString(s.innerText),a=(o=bibtexToObject(s)).year,r=o.author.replace(/\s+/g," ").split(" and ").map(e=>e.split(",").map(e=>e.trim()).reverse().join(" ")).join(" and "),o=o.citationKey,i=findACLValue(e,"Venue"),n=findACLValue(e,"PDF"),{author:r,bibtex:s,id:`ACL-${i}-${a}_`+findACLValue(e,"Anthology ID"),key:o,note:`Accepted @ ${i} (${a})`,pdfLink:n,title:t,venue:i,year:a}},makePNASPaper=async e=>{e=e.replace(".full.pdf","").replace(/\/doi\/e?pdf\//,"/doi/abs/");var t=await fetchDom(e),a=t.getElementsByTagName("h1")[0].innerText,r=queryAll(".authors span[property='author'] a:not([property='email']):not(.orcid-id)",t).filter(e=>!e.getAttribute("href").includes("mailto:")).map(e=>e.innerText).join(" and "),o=t.querySelector("span[property='datePublished']").innerText.match(/\d{4}/g)[0],i=`PNAS-${o}_`+(e.endsWith("/")?e.split("/").slice(-2):e.split("/").slice(-1))[0],e=e.includes("/doi/pdf/")||e.includes("/doi/epdf/")?e.replace("/doi/epdf/","/doi/pdf/"):e.replace("/doi/abs/","/doi/pdf/").replace("/doi/full/","/doi/pdf/"),t=[...t.querySelector(".core-container").getElementsByTagName("a")].map(e=>e.getAttribute("href")).filter(e=>e?.includes("https://doi.org"))[0].split("/").slice(-2).join("/"),n="doi:"+t;return{author:r,bibtex:bibtexToString(`
    @article{${n},
        author={${r}},
        title={${a}},
        journal = {Proceedings of the National Academy of Sciences},
        year={${o}},
        doi={${t}},
        eprint={${e}},
        URL={${e.replace("/doi/pdf/","/doi/abs/")}}
    }`),id:i,key:n,note:`Published @ PNAS (${o})`,pdfLink:e,title:a,venue:"PNAS",year:o}},makeNaturePaper=async e=>{var t,a=(e=e.replace(".pdf","").split("#")[0])+".pdf",r=e.split("/").last(),e=await fetchDom(e),o=e.querySelector("h1.c-article-title").innerText,i=queryAll("ul.c-article-author-list li",e).map(e=>e.innerText.replace(/(\ ?,)|&|…|\d/g,"").split(/orcid/i)[0].trim()).filter(e=>0<e.length).join(" and "),n=e.querySelector(".c-article-info-details").innerText.match(/\(\d{4}\)/)[0].replace(/\(|\)/g,""),s=e.querySelector(".c-article-info-details [data-test]").innerText,r=`Nature-${n}_`+r;let l;for(t of[".c-bibliographic-information__citation",".c-bibliographic-information__value"])if(l=querySelector(t)?.innerText.split("https://doi.org/")[1])break;l=l||[...e.getElementsByTagName("span")].map(e=>e.innerText).filter(e=>e.includes("https://doi.org"))[0];var e=""+i.split(" ")[1]+n+firstNonStopLowercase(o),p={citationKey:e,entryType:"article",author:i,title:o,journal:s,year:n},p=(l&&(p.doi=l,p.url="https://doi.org/"+l),bibtexToString(p));return{author:i,bibtex:p,id:r,key:e,note:`Published @ ${s} (${n})`,pdfLink:a,title:o,venue:s,year:n}},makeACSPaper=async e=>{var e=(e=e.replace("pubs.acs.org/doi/pdf/","pubs.acs.org/doi/").split("?")[0]).replace("/abs/","/").split("/doi/")[1],t=`https://pubs.acs.org/action/downloadCitation?doi=${e}&include=cit&format=bibtex&direct=true`,t=await fetchText(t),a=bibtexToObject(t),r=a.author.replaceAll("\n","").trim(),o=a.title.trim(),i=a.year.trim(),n=a.citationKey.trim(),s="https://pubs.acs.org/doi/pdf/"+e,l=`Published @ ${a.journal} (${a.year})`;return{author:r,bibtex:t,id:"ACS_"+e.replaceAll(".","").replaceAll("/",""),key:n,note:l,pdfLink:s,title:o,venue:a.journal,year:i}},makeIOPPaper=async e=>{(e=e.split("#")[0]).endsWith("/pdf")&&(e=e.slice(0,-4));var t=await fetchDom(e),t=queryAll(".btn-multi-block a",t).filter(e=>"BibTeX"===e.innerText).map(e=>e.getAttribute("href"))[0],t="https://"+parseUrl(e).host+t,t=await fetchText(t),a=bibtexToObject(t),r=a.author.replaceAll("\n","").trim(),o=a.title.trim(),i=a.year.trim(),n=a.citationKey.trim(),s=e+"/pdf",a=a.journal,l=`Published @ ${a} (${i})`,e=e.split("/article/").last().split("/meta")[0];return{author:r,bibtex:t,id:"IOPscience_"+miniHash(e),key:n,note:l,pdfLink:s,title:o,venue:a,year:i}},makeJMLRPaper=async e=>{var t=(e=(e=(e=e.includes("/papers/volume")?e.replace("/papers/volume","/papers/v"):e).endsWith(".pdf")?e.split("/").slice(0,-1).join("/"):e).replace(".html","")).split("/").last(),a=e+".bib",a=await fetchText(a),{author:r,year:o,title:i,citationKey:n}=bibtexToObject(a);return{author:r,bibtex:a,id:`JMLR-${o}_`+t,key:n.trim(),note:`Published @ JMLR (${o})`,pdfLink:e.replace("/papers/v","/papers/volume")+`/${t}.pdf`,title:i,venue:"JMLR",year:o}},makePMCPaper=async e=>{var t=e.match(/PMC\d+/)[0].replace("PMC",""),a=e.split("PMC"+t)[0]+"PMC"+t,r=await(await fetch(`https://api.ncbi.nlm.nih.gov/lit/ctxp/v1/pmc/?format=csl&id=${t}&download=true`)).json(),o=r["epub-date"]?r["epub-date"]["date-parts"][0][0]+"":r.issued["date-parts"][0][0]+"",i=r.author.map(e=>e.given+" "+e.family).join(" and "),n=r["container-title"].split(" ").map(e=>e.capitalize()).join(" "),s=r.title,t=`PMC-${o}_`+t,l=r.author[0].family+o+firstNonStopLowercase(s);let p;return{author:i,bibtex:bibtexToString({entryType:"article",citationKey:l,journal:n,issn:r.ISSN,volume:r.volume,page:r.page,doi:r.DOI,PMID:r.PMID,PMCID:r.PMCID,publisher:r.publisher,author:i,title:s}),id:t,key:l,note:`Published @ ${n} (${o})`,pdfLink:p=isPdfUrl(e)?e:a+"/pdf",title:s,venue:n,year:o}},makePubMedPaper=async e=>{var e=[...(await fetchDom(e.split("?")[0])).getElementsByTagName("meta")].filter(e=>e.getAttribute("name")?.includes("citation_")),e=Object.fromEntries(e.map(e=>[e.getAttribute("name").replace("citation_",""),e.getAttribute("content")])),t=document.querySelector("div.authors-list").innerText.replace(/\d/gi,"").split(",").map(e=>e.trim()).join(" and "),a=e.title,r=e.journal_title,o=e.date.split("/")[2],i=`PubMed-${o}_`+e.pmid,n=""+t.split(" and ")[0].split(" ").last()+o+firstNonStopLowercase(e.title),e={entryType:"article",citationKey:n,publisher:e.publisher,doi:e.doi,issn:e.issn,journal:r,year:o,author:t};return{author:t,bibtex:bibtexToString(e),id:i,key:n,note:`Accepted @ ${journal} (${o})`,pdfLink:"",title:a,venue:r,year:o}},makeIJCAIPaper=async e=>{var t=e.endsWith(".pdf")?e.replace(".pdf","").split("/").last().match(/[1-9]\d*/)[0]:e.split("/").last(),e=e.match(/proceedings\/\d+/gi)[0].split("/")[1],a=(await fetchText(`https://www.ijcai.org/proceedings/${e}/bibtex/`+t)).replace(/}\n/gi,"},\n"),r=bibtexToObject(a.split("\n").filter(e=>!/note\s+=/gi.test(e)).join("\n")),o=r.citationKey,i=r.title;return{author:flipAndAuthors(r.author),bibtex:a,id:`IJCAI-${e}_`+t,key:o,note:`Accepted @ IJCAI (${e})`,pdfLink:`https://www.ijcai.org/proceedings/${e}/${t.padStart(4,0)}.pdf`,title:i,venue:"IJCAI",year:e}},makeACMPaper=async e=>{let t;e=noParamUrl(e),t=isPdfUrl(e)?e:e.replace(/\/doi\/?(abs|full)?\//,"/doi/pdf/");var a=await fetchDom(e.replace("/doi/pdf/","/doi/"));let r,o,i,n,s,l,p,c;var d=extractDataFromDCMetaTags(a),a=(d?{author:r,year:o,title:i,venue:n,key:s,doi:l,bibtex:p,note:c}=d:(i=a.querySelector(".citation__title").innerText,r=queryAll("ul[aria-label='authors'] li.loa__item .loa__author-name",a).map(e=>e.innerText.replace(",","").trim()).join(" and "),d=a.querySelector(".issue-item__detail a").innerText,n=d.split("'")[0].trim(),o="20"+d.split("'")[1].split(":")[0].trim(),l=t.split("/doi/pdf/")[1],c=`Accepted @ ${n} (${o})`,s=l,p=bibtexToString({entryType:"article",citationKey:l,journal:n,author:r,title:i,year:o,publisher:"Association for Computing Machinery",address:"New York, NY, USA",url:noParamUrl(e).replace("/doi/pdf/","/doi/")})),`ACM-${o}_`+miniHash(l));return{author:r,bibtex:p,id:a,key:s,note:c,pdfLink:t,title:i,venue:n,year:o}},makeIEEEPaper=async e=>{isPdfUrl(e)&&(e=`https://ieeexplore.ieee.org/document/${e.split("/stamp/stamp.jsp?tp=&arnumber=")[1].match(/\d+/)[0]}/`);var t=await fetchDom(e),t=JSON.parse([...t.getElementsByTagName("script")].filter(e=>e.innerHTML?.includes("metadata="))[0].innerHTML.split("metadata=")[1].split(/};\s*/)[0]+"}"),a=t.title,r=t.authors.map(e=>e.name).join(" and "),o=t.publicationYear,e=""+parseUrl(e).origin+t.pdfUrl,i=t.publicationTitle,n=t.articleId;return{author:r,bibtex:bibtexToString({entryType:"article",citationKey:n,journal:i,volume:t.volume,pages:t.startPage+"-"+t.endPage,doi:t.doi,title:a,year:o,author:r}),id:`IEEE-${o}_`+n,key:n,note:`Accepted @ ${i} (${o})`,pdfLink:e,title:a,venue:i,year:o}},makeSpringerPaper=async t=>{var e=[...global.sourceExtras.springer.types,"content/pdf"],a=e.find(e=>t.includes(`/${e}/`));if(!a)throw new Error(`Could not find Springer type for ${t} (known: ${e.join(", ")})`);var r,o,i,n,s,l,e=t.split(`/${a}/`)[1].split("?")[0].replace(".pdf",""),p=(await fetchCrossRefDataForDoi(e)).data;if(p)return{author:r,bibtex:o,citationKey:i,year:n,title:s,venue:l}=p,{author:r,bibtex:o,id:`Springer-${n}_`+miniHash(e),key:i,note:`Published @ ${l} (${n})`,pdfLink:p.pdf??("content/pdf"===a?t:t.replace(`/${a}/`,"/content/pdf/")+".pdf"),title:s,venue:l,year:n,extra:{url:"https://doi.org/"+e}};throw new Error("Aborting Springer paper parsing, see error above")},makeAPSPaper=async e=>{e=e.split("#")[0];var[t,a]=parseUrl(e).pathname.split("/").slice(1,3),r=e.split(`/${t}/${a}/`).last(),o=e.replace(`/${t}/${a}/`,`/${t}/export/`),o=await fetchText(o+"?type=bibtex&download=true"),i=bibtexToObject(o),e=e.replace(`/${t}/${a}/`,`/${t}/pdf/`),a=`APS-${i.year}_`+miniHash(r),t=i.journal??i.publisher,r=(await readJournalAbbreviations(),global.journalAbbreviations[miniHash(t)]??t),t=`Published @ ${r} (${i.year})`;return{author:flipAndAuthors(i.author),bibtex:o,id:a,key:i.citationKey,note:t,pdfLink:e,title:i.title,venue:r,year:i.year}},makeWileyPaper=async e=>{var e=(e=noParamUrl(e)).match(/\/doi\/10\./g)?e.replace("/doi/","/doi/pdf/"):e.replace(/\/doi\/(abs|epdf|full)\//g,"/doi/pdf/"),t=e.replace("/doi/pdf/","/doi/abs/").split("/doi/abs/")[1],a=await fetchBibtexToPaper({doi:t}),{author:r,title:o,year:i}=a,n=`Wiley-${i}_`+miniHash(t),s=a.bibtex,l=a.journal,a=(a.publisher,`Published @ ${l} (${i})`);return{author:r,bibtex:s,id:n,key:miniHash(t),note:a,pdfLink:e,title:o,venue:l,year:i,doi:t}},makeScienceDirectPaper=async e=>{var e=e.split("/pii/")[1].split("/")[0].split("#")[0].split("?")[0],t=await fetchText(`https://www.sciencedirect.com/sdfe/arp/cite?pii=${e}&format=text%2Fx-bibtex&withabstract=false`),{author:a,journal:r,year:o,title:i,citationKey:n}=bibtexToObject(t),s=`Published @ ${r} (${o})`;return{author:a,bibtex:t,id:`ScienceDirect-${o}_`+miniHash(e),key:n,note:s,pdfLink:"https://reader.elsevier.com/reader/sd/pii/"+e,title:i,venue:r??"Science Direct",year:o}},makeSciencePaper=async e=>{let t,a,r,o,i,n,s,l,p,c,d;n="https://science.org/doi/pdf/"+(c=(c=noParamUrl(e).split("/doi/")[1]).startsWith("10.")?c:c.split("/").slice(1).join("/")),d="https://science.org/doi/full/"+c;var e=(await fetchCrossRefDataForDoi(c)).data;return e?({author:t,bibtex:a,title:s,venue:l,year:p}=e,o=e.citationKey,i=`Published @ ${l} (${p})`):(e=await fetchDom(d),{author:t,year:p,publisher,title:s,venue:l,key:o,bibtex:a,note:i}=extractDataFromDCMetaTags(e)),r=`Science-${p}_`+miniHash(c),{author:t,bibtex:a,id:r,key:o,note:i,pdfLink:n,title:s,venue:l,year:p}},makeFrontiersPaper=async e=>{e=e.replace(/\/pdf$/,"/full");var t=noParamUrl(e).split("/articles/")[1].split("/full")[0],a=await fetchText(`https://www.frontiersin.org/articles/${t}/bibTex`),a=Object.fromEntries(Object.entries(bibtexToObject(a)).map(([e,t])=>["citationKey"===e||"entryType"===e?e:e.toLowerCase(),t])),{author:r,journal:o,year:i,title:n,citationKey:s}=(a.author=flipAndAuthors(a.author),delete a.abstract,a),l=`Published @ ${o} (${i})`;return{author:r,bibtex:bibtexToString(a),id:`Frontiers-${i}_`+miniHash(t),key:s,note:l,pdfLink:e.replace(/\/full$/,"/pdf"),title:n,venue:o,year:i}},makeIHEPPaper=async a=>{let r,o;if(a.includes("/files/")){let t=a.split("/files/")[1].split("/")[0];var i="https://inspirehep.net/api/literature?q=documents.key:"+t,i=(await fetchJSON(i)).data;if(!(r=i.hits.hits.find(e=>!!e.metadata.documents.find(e=>e.key===t))))return void warn("Could not find an Inspire HEP record for the url",a);o=r.metadata.control_number}else o=a.match(/\/literature\/(\d+)/)[1];if(o){var i=await fetchText(`https://inspirehep.net/api/literature/${o}?format=bibtex`),t=(r||({data:r}=await fetchJSON(`https://inspirehep.net/api/literature/${o}?format=json`)),bibtexToObject(i));let e=t.title??r.metadata.titles[0].title;e.startsWith("{")&&e.endsWith("}")&&(e=e.slice(1,-1));var n=r.metadata.documents?.[0]?.url??a,s=flipAndAuthors(t.author),l=t.year??r.created.split("-")[0],p="IHEP-"+o,c=t.journal??"Inspire HEP",d=t.citationKey,t=t.doi??"";return{author:s,bibtex:i,id:p,key:d,note:`Published @ ${c} (${l})`,pdfLink:n,title:e,venue:c,year:l,doi:t}}warn("Could not find an Inspire HEP id for the url",a)},makePLOSPaper=async e=>{var t=e.split("?id=").last().split("&")[0],{bibtex:a,key:r,author:o,venue:i,title:n,note:s,year:l}=await fetchBibtexToPaper({doi:t}),p=e.split("/article")[0]+`/article/file?id=${t}&type=printable`,e=e.split("journals.plos.org/")[1].split("/")[0];return{author:flipAndAuthors(o),bibtex:a,id:`PLOS-${e}_`+miniHash(t),key:r,note:s,pdfLink:p,title:n,venue:i,year:l,doi:t}},makeRSCPaper=async e=>{var t=(e=noParamUrl(e).replace("/unauth","")).split("/").last(),a=e.split("/").find(e=>"articlehtml"===e||"articlepdf"===e||"articlelanding"===e).replace("article",""),e="articlepdf"===a?e:e.replace(`/article${a}/`,"/articlepdf/"),{bibtex:a,key:r,author:o,venue:i,title:n,note:s,year:l,doi:p}=await fetchBibtexToPaper({url:`https://pubs.rsc.org/en/content/formatedresult?markedids=${t}&downloadtype=article&managertype=bibtex`});return{author:flipAndAuthors(o),bibtex:a,id:`RSC-${i.replaceAll(" ","")}_`+miniHash(t),key:r,note:s,pdfLink:e,title:n,venue:i,year:l,doi:p}},parseAIPIdOrDOI=e=>isPdfUrl(noParamUrl(e))?{doi:noParamUrl(e).split("/").last().split("_").last().replace(".pdf","")}:{aipId:(e.includes("/article/")?e.split("/article/"):e.includes("/article-split/")?e.split("/article-split/"):e.split("/article-abstract/"))[1].split("/")[3]},makeAIPPaper=async e=>{var t,a,r,o,i,n,s,l,p;if(e=noParamUrl(e),!isPdfUrl(e))return e=parseAIPIdOrDOI(e).aipId,t=`https://pubs.aip.org/Citation/Download?resourceId=${e}&resourceType=3&citationFormat=2`,{author:t,bibtex:a,key:r,note:o,eprint:i,title:n,venue:s,year:l,doi:p}=await fetchBibtexToPaper({url:t}),{author:t,bibtex:a,id:`AIP-${l}_`+miniHash(e),key:r,note:o,pdfLink:i.replaceAll("\\",""),title:n,venue:s,year:l,doi:p};warn("PaperMemory cannot parse AIP papers from pdf urls")},makeWebsitePaper=async e=>{var t=e.url,a=await fetchDom(t),a=Object.fromEntries([...a.querySelectorAll("meta")].filter(e=>e.getAttribute("property")).filter(e=>e.getAttribute("property").startsWith("og:")).map(e=>[e.getAttribute("property").replace("og:",""),e.getAttribute("content")])),r=a.site_name||parseUrl(t).hostname.replace("www.","").capitalize(),o=(new Date).getFullYear()+"",i="Website_"+urlToWebsiteId(t),n=a.description||"",s=t,a=a.title||e.title,e=miniHash(r)+o+firstNonStopLowercase(a),t=`@misc{${e},
        author = {${r}},
        title = {${a}},
        year = {${o}},
        url = {${t}},
        note = {Accessed ${(new Date).toISOString().split("T")[0]}}
    }`;return{author:r,bibtex:bibtexToString(bibtexToObject(t)),id:i,key:e,note:n,pdfLink:s,title:a,venue:"",year:o}},makeMDPIPaper=async e=>{(e=(e=(e=noParamUrl(e)).split("/").last().startsWith("pdf")?e.split("/").slice(0,-1).join("/"):e).endsWith("/notes")?e.replace("/notes",""):e).endsWith("/reprints")&&(e=e.replace("/reprints",""));var t=await fetchDom(e),{author:t,year:a,title:r,venue:o,key:i,doi:n,bibtex:s,note:l,pdfLink:p}=extractDataFromDCMetaTags(t);return{author:t,bibtex:s,id:`MDPI-${a}_`+miniHash(e.split("mdpi.com/")[1]),key:i,note:l,pdfLink:p,title:r,venue:o,year:a,doi:n}},makeOUPPaper=async e=>{var t=(e=noParamUrl(e)).split("/").last(),t=await fetchText(`https://academic.oup.com/Citation/Download?resourceId=${t}&resourceType=3&citationFormat=2`),a=bibtexToObject(t),{title:a,year:r,author:o,journal:i,doi:n,citationKey:s,eprint:l}=(delete a.abstract,t=bibtexToString(a),a),o=flipAndAuthors(o),p=`Published @ ${i} (${r})`,c=e.split("https://academic.oup.com/")[1].split("/").slice(2).join("");return{author:o,bibtex:t,id:`OUP-${r}_`+miniHash(c),key:s,note:p,pdfLink:l?.replaceAll("\\","")??e,title:a,venue:i,year:r,doi:n}},makerHALPaper=async e=>{var t=(e=noParamUrl(e).replace(/(hal\.science\/\w+-\d+)(v\d+)?(\/document)?/,"$1")).split("/").last(),a=`https://hal.science/${t}/bibtex`,a=await fetchText(a),r=bibtexToObject(a),{title:o,year:i,journal:n,author:s,doi:l,pdf:p}=r,c=n?`Published @ ${n} (${i})`:"",r=r.citationKey;return{author:flipAndAuthors(s),bibtex:bibtexToString(a),id:`HAL-${i}_`+miniHash(t),key:r,note:c,pdfLink:p??e,title:o,venue:n,year:i,doi:l}},makeChemRxivPaper=async e=>{let t,a=e;isPdfUrl(e)?(t=e.split("/item/")[1].split("/")[0],a="https://chemrxiv.org/engage/chemrxiv/article-details/"+t):t=noParamUrl(e).split("/").last();var e=await fetchDom(a),{author:e,year:r,title:o,venue:i,key:n,doi:s,bibtex:l,pdfLink:p,note:c}=extractDataFromDCMetaTags(e);return{author:e,bibtex:l,id:`ChemRxiv-${r}_`+miniHash(t),key:n,note:c,pdfLink:p,title:o,venue:i,year:r,doi:s}},findCellPii=async e=>{var t=e.toLowerCase().includes("showpdf"),o=e.toLowerCase().includes("pdfextended");let i;if(t||o){for(;!global.state.cellJournalData;)console.log("Waiting for cell journal data..."),await sleep(5);o=global.state.cellJournalData;let a=(i=t?new URL(e).searchParams.get("pii"):e.split("/").last()).match(/\d{4}-\d{3}[0-9X]/g)[0],r;Object.entries(o).forEach(([e,t])=>{t.issn.includes(a)&&(r=e)});o=r.split(" ").map(e=>e.toLowerCase()).join("-");e=(e=t?noParamUrl(e).split("/showPdf")[0]+(`/${o}/fulltext/`+i):noParamUrl(e).split("/pdfExtended")[0]+("/fulltext/"+i)).replace("/action/","/")}else i=noParamUrl(e).split("/").last();return{pii:i,url:e}},makeCellPaper=async e=>{({pii:t,url:e}=await findCellPii(e));var t="https://www.cell.com/action/showPdf?pii="+t,a=(await fetchDom(e)).head.querySelector('meta[name="citation_doi"]').getAttribute("content"),{author:r,year:o,title:i,venue:n,bibtex:s,note:l,citationKey:p}=await fetchBibtexToPaper({doi:a});return{author:r,bibtex:s,id:`Cell-${o}_`+miniHash(e.split("cell.com/")[1]),key:p,note:l,pdfLink:t,title:i,venue:n,year:o,doi:a}},tryPWCMatch=async e=>{let t;var a,r={type:"papersWithCode",pwcPrefs:await getStorage("pwcPrefs")??{},paper:e},{url:r,note:o,venue:i,pubYear:n}=await sendMessageToBackground(r)??{};return r&&!e.codeLink?log("[PapersWithCode] Discovered a code repository:",r):log("[PapersWithCode] No code repository found"),i&&!e.venue?(log("[PapersWithCode] Found a publication venue:",i),a=bibtexToObject(e.bibtex),t=bibtexToString({...a,year:n,journal:i})):e.venue||log("[PapersWithCode] No publication found"),{codeLink:r,note:o,venue:i,bibtex:t}},tryCrossRef=async(e,t)=>{if(t)return sendMessageToBackground({type:"try-cross-ref",paper:e});try{var a="https://api.crossref.org/works?rows=1&mailto=schmidtv%40mila.quebec&select=event%2Ctitle&query.title="+encodeURI(e.title),r=await fetch(a).then(e=>e.json());if("ok"!==r.status)return log(`[Crossref] ${a} returned `+r.message.status),{};if(0===r.message.items.length)return{};if(r.message.items[0].title[0]?.toLowerCase().replaceAll("\n"," ").replaceAll(/\s\s+/g," ")!==e.title.toLowerCase().replaceAll("\n"," ").replaceAll(/\s\s+/g," "))return{};if(!r.message.items[0].event||!r.message.items[0].event.name)return{};info("Found a CrossRef match");var o=r.message.items[0].event.name.trim();return{venue:o,note:`Accepted @ ${o} -- [crossref.org]`}}catch(e){return logError("[Crossref]",e),{}}},tryDBLP=async(e,t)=>{if(t)return sendMessageToBackground({type:"try-dblp",paper:e});try{var a=encodeURI(e.title),r=await fetch(`https://dblp.org/search/publ/api?q=${a}&format=json`);if(429===r.status)return{status:429};var o,i,n,s,l,p=await r.json();if(p.result&&p.result.hits&&p.result.hits.hit&&p.result.hits.hit.length)for(o of p.result.hits.hit.sort((e,t)=>parseInt(e.info.year,10)-parseInt(t.info.year,10)))if(decodeHtml(o.info.title?.toLowerCase().replaceAll("\n"," ").replaceAll(".","").replaceAll(/\s\s+/g," "))===e.title.toLowerCase().replaceAll("\n"," ").replaceAll(".","").replaceAll(/\s\s+/g," ")&&"CoRR"!==o.info.venue)return info("Found a DBLP match"),i=await fetchText(o.info.url+".bib"),n=miniHash(o.info.venue),await readJournalAbbreviations(),s=(global.journalAbbreviations[n]??o.info.venue).trim(),l=o.info.year,o.info.url,{venue:s,note:`Accepted @ ${s} ${l} -- [dblp.org]`,bibtex:i};return{}}catch(e){return logError("[DBLP]",e),{}}},trySemanticScholar=async(t,e)=>{if(e)return sendMessageToBackground({type:"try-semantic-scholar",paper:t});try{var{data:a,status:r}=await fetchJSON(`https://api.semanticscholar.org/graph/v1/paper/search?query=${encodeURI(t.title)}&fields=title,venue,year,authors,externalIds,url&limit=5`);if(a&&a.data&&0<a.data.length)for(var o of a.data)if(miniHash(o.title)===miniHash(t.title)&&Math.abs(o.year-t.year)<3&&o.venue&&!o.venue.toLowerCase().includes("arxiv")&&!o.venue.toLowerCase().includes("biorxiv")){info("Found a Semantic Scholar match");let e=o.venue.trim().replace(/^\d{4}/,"").trim();e.indexOf(" ")<0&&(e=e.toUpperCase());var i=(o.year+"").trim(),n=`Accepted @ ${e} (${i}) -- [semanticscholar.org]`,s=o.authors.map(e=>e.name).join(" and "),l=o.externalIds.DOI,p=bibtexToString({entryType:"article",citationKey:miniHash(o.authors[0].name.split(" ").last())+i+firstNonStopLowercase(t.title),title:t.title,author:s,journal:e,year:i,doi:l,bibSource:"Semantic Scholar "+o.url});return{venue:e,note:n,bibtex:p,status:r}}return{status:r}}catch(e){logError("[SemanticScholar]",e)}return{status:404}},tryGoogleScholar=async e=>{e=await sendMessageToBackground({type:"google-scholar",paper:e});return e.note&&info("Found a Google Scholar match",e.note),e},tryUnpaywall=async(t,e)=>{if(e)return sendMessageToBackground({type:"try-unpaywall",paper:t});var e=`https://api.unpaywall.org/v2/search?query=${encodeURI(t.title)}&is_oa=true&email=papermemory+${parseInt(1e3*Math.random())}@gmail.com`,{data:e,status:a}=await fetchJSON(e);if(e&&200===a){var r,e=e.results?.find(e=>miniHash(e.response.title)===miniHash(t.title));if(e&&e.journal_name)return{venue:r=e.journal_name,note:`Accepted @ ${r} (${e.year}) -- [unpaywall.org]`,doi:e.doi}}return{status:a}},tryPreprintMatch=async(e,t=!1)=>{let a,r,o,i,n;var s,l,p={},c=["GoogleScholar","SemanticScholar","CrossRef","DBLP","Unpaywall"],d=[silentPromiseTimeout(tryGoogleScholar(e)),silentPromiseTimeout(trySemanticScholar(e,!0)),silentPromiseTimeout(tryCrossRef(e)),silentPromiseTimeout(tryDBLP(e)),silentPromiseTimeout(tryUnpaywall(e))];t&&(d.push(silentPromiseTimeout(tryPWCMatch(e))),c.push("PapersWithCode"));for([s,l]of Object.entries(c)){if(p[l]=await d[s],{note:a,venue:r,bibtex:o,doi:n}=p[l]??{},a)break;log(`[${l}] No publication found`)}return t&&(p.hasOwnProperty(c="PapersWithCode")||(p[c]=await silentPromiseTimeout(d[c])),p[c].codeLink)&&!e.codeLink&&(i=p[c].codeLink),{note:a,venue:r,bibtex:o,code:i,doi:n}},initPaper=async e=>{for(var t in e.note||(e.note=""),e.md=`[${e.title}](${e.pdfLink})`,e.tags=[],e.codeLink=e.codeLink??"",e.favorite=!1,e.favoriteDate="",e.addDate=(new Date).toJSON(),e.lastOpenDate=e.addDate,e.count=1,e.code={},e.doi=e.doi??bibtexToObject(e.bibtex).doi??"",e)e.hasOwnProperty(t)&&"string"==typeof e[t]&&(e[t]=e[t].trim());return e=await autoTagPaper(e),validatePaper(e),e},autoTagPaper=async a=>{try{var e,r,o=await getStorage("autoTags");if(o&&o.length){let t=new Set;for(var i of o)i.tags?.length&&(i.title||i.author)&&(e=!i.title||new RegExp(i.title,"i").test(a.title),r=!i.author||new RegExp(i.author,"i").test(a.author),e)&&r&&i.tags.forEach(e=>t.add(e));a.tags=[...t].sort(),a.tags.length&&log("Automatically adding tags:",a.tags)}return a}catch(e){return log("Error auto-tagging:",e),log("Paper:",a),a}},makePaper=async(e,t,a=!1)=>{let r;var o=performance.now();if(info("Making paper..."),a)(r=await makeWebsitePaper(a))&&(r.source="website");else if(e.arxiv)(r=await makeArxivPaper(t))&&(r.source="arxiv");else if(e.neurips)(r=await makeNeuripsPaper(t))&&(r.source="neurips");else if(e.cvf)(r=await makeCVFPaper(t))&&(r.source="cvf");else if(e.openreview)(r=await makeOpenReviewPaper(t))&&(r.source="openreview");else if(e.biorxiv)(r=await makeBioRxivPaper(t))&&(r.source="biorxiv");else if(e.pmlr)(r=await makePMLRPaper(t))&&(r.source="pmlr");else if(e.acl)(r=await makeACLPaper(t))&&(r.source="acl");else if(e.pnas)(r=await makePNASPaper(t))&&(r.source="pnas");else if(e.nature)(r=await makeNaturePaper(t))&&(r.source="nature");else if(e.acs)(r=await makeACSPaper(t))&&(r.source="acs");else if(e.iop)(r=await makeIOPPaper(t))&&(r.source="iop");else if(e.jmlr)(r=await makeJMLRPaper(t))&&(r.source="jmlr");else if(e.pmc)(r=await makePMCPaper(t))&&(r.source="pmc");else if(e.ijcai)(r=await makeIJCAIPaper(t))&&(r.source="ijcai");else if(e.acm)(r=await makeACMPaper(t))&&(r.source="acm");else if(e.ieee)(r=await makeIEEEPaper(t))&&(r.source="ieee");else if(e.springer)(r=await makeSpringerPaper(t))&&(r.source="springer");else if(e.aps)(r=await makeAPSPaper(t))&&(r.source="aps");else if(e.wiley)(r=await makeWileyPaper(t))&&(r.source="wiley");else if(e.sciencedirect)(r=await makeScienceDirectPaper(t))&&(r.source="sciencedirect");else if(e.science)(r=await makeSciencePaper(t))&&(r.source="science");else if(e.frontiers)(r=await makeFrontiersPaper(t))&&(r.source="frontiers");else if(e.ihep)(r=await makeIHEPPaper(t))&&(r.source="ihep");else if(e.plos)(r=await makePLOSPaper(t))&&(r.source="plos");else if(e.rsc)(r=await makeRSCPaper(t))&&(r.source="rsc");else if(e.mdpi)(r=await makeMDPIPaper(t))&&(r.source="mdpi");else if(e.oup)(r=await makeOUPPaper(t))&&(r.source="oup");else if(e.hal)(r=await makerHALPaper(t))&&(r.source="hal");else if(e.chemrxiv)(r=await makeChemRxivPaper(t))&&(r.source="chemrxiv");else if(e.cell)(r=await makeCellPaper(t))&&(r.source="cell");else{if(!e.aip)throw console.error({is:e,url:t}),new Error("Could not parse paper (in `makePaper`). Unknown paper source, see above.");(r=await makeAIPPaper(t))&&(r.source="aip")}if(void 0!==r)return a=(performance.now()-o)/1e3,info(`Paper parsed in ${a.toFixed(2)}s`),initPaper(r)},findFuzzyPaperMatch=(e,t)=>{t=miniHash(t.title);return e.hasOwnProperty(t)?(e=e[t]).find(t=>!global.preprintSources.some(e=>t.toLowerCase().startsWith(e)))||e[0]:null};"undefined"!=typeof module&&null!=module.exports&&((dummyModule=module).exports={decodeHtml:decodeHtml,flipAuthor:flipAuthor,flipAndAuthors:flipAndAuthors,fetchArxivXML:fetchArxivXML,fetchCvfHTML:fetchCvfHTML,getOpenReviewNoteJSON:getOpenReviewNoteJSON,getOpenReviewForumJSON:getOpenReviewForumJSON,fetchDom:fetchDom,fetchText:fetchText,fetchJSON:fetchJSON,fetchBibtexToPaper:fetchBibtexToPaper,extractCrossrefData:extractCrossrefData,fetchCrossRefDataForDoi:fetchCrossRefDataForDoi,fetchSemanticScholarDataForDoi:fetchSemanticScholarDataForDoi,getMetaContent:getMetaContent,extractDataFromDCMetaTags:extractDataFromDCMetaTags,makeArxivPaper:makeArxivPaper,makeNeuripsPaper:makeNeuripsPaper,makeCVFPaper:makeCVFPaper,makeOpenReviewBibTex:makeOpenReviewBibTex,extractAPIv2ContentValue:extractAPIv2ContentValue,makeOpenReviewPaper:makeOpenReviewPaper,makeBioRxivPaper:makeBioRxivPaper,makePMLRPaper:makePMLRPaper,findACLValue:findACLValue,makeACLPaper:makeACLPaper,makePNASPaper:makePNASPaper,makeNaturePaper:makeNaturePaper,makeACSPaper:makeACSPaper,makeIOPPaper:makeIOPPaper,makeJMLRPaper:makeJMLRPaper,makePMCPaper:makePMCPaper,makePubMedPaper:makePubMedPaper,makeIJCAIPaper:makeIJCAIPaper,makeACMPaper:makeACMPaper,makeIEEEPaper:makeIEEEPaper,makeSpringerPaper:makeSpringerPaper,makeAPSPaper:makeAPSPaper,makeWileyPaper:makeWileyPaper,makeScienceDirectPaper:makeScienceDirectPaper,makeSciencePaper:makeSciencePaper,makeFrontiersPaper:makeFrontiersPaper,makeIHEPPaper:makeIHEPPaper,makePLOSPaper:makePLOSPaper,makeRSCPaper:makeRSCPaper,makeWebsitePaper:makeWebsitePaper,makeMDPIPaper:makeMDPIPaper,makeOUPPaper:makeOUPPaper,makerHALPaper:makerHALPaper,tryPWCMatch:tryPWCMatch,tryCrossRef:tryCrossRef,tryDBLP:tryDBLP,trySemanticScholar:trySemanticScholar,tryGoogleScholar:tryGoogleScholar,tryUnpaywall:tryUnpaywall,tryPreprintMatch:tryPreprintMatch,initPaper:initPaper,autoTagPaper:autoTagPaper,makePaper:makePaper,findFuzzyPaperMatch:findFuzzyPaperMatch});